
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Datos &#8212; Aprendizaje automático</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Estadística descriptiva básica" href="2_estadisticos.html" />
    <link rel="prev" title="Preliminares" href="0_preliminares.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="es">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Aprendizaje automático</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Aprendizaje automático
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="0_preliminares.html">
   Preliminares
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_estadisticos.html">
   Estadística descriptiva básica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_sel_carac.html">
   Extracción de características
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_no_supervisado.html">
   Aprendizaje no supervisado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_supervisado.html">
   Aprendizaje supervisado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_clasificacion.html">
   Clasificación
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_diseno_experimentos.html">
   Diseño de experimentos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_comparativas_desempeno.html">
   Comparativas de desempeño
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_resultados.html">
   Resultados
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_articulo.html">
   Artículo científico
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/albertobenavides/aprendizaje_autom/master?urlpath=tree/docs/caps/1_datos.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/albertobenavides/aprendizaje_autom"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/albertobenavides/aprendizaje_autom/issues/new?title=Issue%20on%20page%20%2Fcaps/1_datos.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/caps/1_datos.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Datos</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="datos">
<h1>Datos<a class="headerlink" href="#datos" title="Enlazar permanentemente con este título">#</a></h1>
<p>Parte fundamental de la ciencia de datos consiste en importar información y preprocesarla. La carga de información puede ser por varios métodos. El <strong>preprocesamiento</strong> suele tomar considerable tiempo en el proceso de análisis de datos. Éste proceso consiste en modificar la información recibida de tal manera que esté lista para utilizarse para posteriores análisis.</p>
<p>Como ejemplo para el curso, se usa un conjunto de datos georrerefenciados por trece estaciones de monitoreo del Área Metropolitana de Monterrey durante 2017 y 2019. Estas estaciones recogen datos meteorológicos y de contaminantes ambientales cada hora por parte del <a class="reference external" href="http://aire.nl.gob.mx/">Sistema Integral de Monitoreo Ambiental</a>.</p>
<p>A continuación se muestran los valores que se registran.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Arreglo de diccionarios</span>
<span class="n">pollutants</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">text</span><span class="si">{PM}</span><span class="s1">_</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">850</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;$\mu</span><span class="se">\\</span><span class="s1">text</span><span class="si">{gr}</span><span class="s1">$ / $</span><span class="se">\\</span><span class="s1">text</span><span class="si">{m}</span><span class="s1">^3$&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">text</span><span class="si">{PM}</span><span class="s1">_</span><span class="si">{2.5}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">850</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;$\mu</span><span class="se">\\</span><span class="s1">text</span><span class="si">{gr}</span><span class="s1">$ / $</span><span class="se">\\</span><span class="s1">text</span><span class="si">{m}</span><span class="s1">^3$&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">text</span><span class="si">{O}</span><span class="s1">_3$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;ppb&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">350</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;ppb&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">text</span><span class="si">{NO}</span><span class="s1">_2$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;ppb&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">text</span><span class="si">{NO}</span><span class="s1">_X$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">350</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;ppb&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">text</span><span class="si">{SO}</span><span class="s1">_2$&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;ppb&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mf">0.050</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;ppm&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;C&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Relative humidity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;%&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Barometric pressure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">650</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">750</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;mmHg&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Solar radiation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;Langley / h&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Rainfall&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;mm / h&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Wind velocity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;Km / h&#39;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Wind direction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_value&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max_value&#39;</span> <span class="p">:</span> <span class="mi">360</span><span class="p">,</span>
    <span class="s1">&#39;unit&#39;</span> <span class="p">:</span> <span class="s1">&#39;Azimutales&#39;</span>
  <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://pandas.pydata.org/"><code class="docutils literal notranslate"><span class="pre">pandas</span></code></a> es una librería de Python que permite manipular fuentes de datos como tablas (o <em>dataframes</em>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Permite mostrar Markdown como salida en Jupyter</span>
<span class="c1"># https://stackoverflow.com/a/36313217</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_def</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pollutants</span><span class="p">)</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">df_pollutants_def</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<p>| name                |   min_value |   max_value | unit                          |
|:--------------------|------------:|------------:|:------------------------------|
| $\text{PM}<em>{10}$    |        2    |       850   | $\mu\text{gr}$ / $\text{m}^3$ |
| $\text{PM}</em>{2.5}$   |        2    |       850   | $\mu\text{gr}$ / $\text{m}^3$ |
| $\text{O}_3$        |        1    |       200   | ppb                           |
| NO                  |        1    |       350   | ppb                           |
| $\text{NO}_2$       |        1    |       150   | ppb                           |
| $\text{NO}_X$       |        1    |       350   | ppb                           |
| $\text{SO}_2$       |        1    |       200   | ppb                           |
| CO                  |        0.05 |        15   | ppm                           |
| Temperature         |      -15    |        50   | C                             |
| Relative humidity   |        0    |       100   | %                             |
| Barometric pressure |      650    |       750   | mmHg                          |
| Solar radiation     |        0    |         1.2 | Langley / h                   |
| Rainfall            |        0    |       inf   | mm / h                        |
| Wind velocity       |        0    |        60   | Km / h                        |
| Wind direction      |        0    |       360   | Azimutales                    |</p>
</div>
</div>
<p>El objetivo de este estudio radica en hacer interpolación espacio temporal mediante métodos de aprendizaje automático.</p>
<p>Un archivo CSV tiene una parte de la base de datos, que se cargan con <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code>.</p>
<p>Como una columna de datos contiene información temporal en un formato que no se apega a los estándares de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, hace falta transformarla. Se usa la librería <a class="reference external" href="https://docs.python.org/3/library/datetime.html"><code class="docutils literal notranslate"><span class="pre">datetime</span></code></a> y aprovechamos de usar el maravilloso <code class="docutils literal notranslate"><span class="pre">lambda</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://towardsdatascience.com/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">custom_date_parser</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y %H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/all.csv&quot;</span><span class="p">,</span>
  <span class="c1"># Especifica qué columnas se van a leer</span>
  <span class="n">usecols</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;station&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NO2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NOX&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PM10&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pressure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rainfall&#39;</span><span class="p">,</span>
    <span class="s1">&#39;humidity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SO2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;solar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;temperature&#39;</span><span class="p">,</span>
    <span class="s1">&#39;velocity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;direction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;valid&#39;</span><span class="p">,</span>
  <span class="p">],</span>
  <span class="c1"># Qué tipo de dato corresponde a cada columna</span>
  <span class="n">dtype</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;timestamp&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s1">&#39;station&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s1">&#39;CO&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;NO&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;NO2&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;NOX&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;O3&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;PM10&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;PM2_5&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;pressure&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;rainfall&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;humidity&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;SO2&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;solar&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;temperature&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;velocity&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;direction&#39;</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s1">&#39;valid&#39;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="c1"># En la columna timestamp</span>
  <span class="n">parse_dates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span>
  <span class="c1"># Guardar las fechas preprocesadas</span>
  <span class="n">date_parser</span> <span class="o">=</span> <span class="n">custom_date_parser</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Total de registros</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df_pollutants_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1542696
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Primeros datos</span>
<span class="n">df_pollutants_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>pressure</th>
      <th>rainfall</th>
      <th>humidity</th>
      <th>SO2</th>
      <th>solar</th>
      <th>temperature</th>
      <th>velocity</th>
      <th>direction</th>
      <th>valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1993-01-01</td>
      <td>Sureste</td>
      <td>0.95</td>
      <td>0.25</td>
      <td>5.75</td>
      <td>6.75</td>
      <td>19.0</td>
      <td>41.0</td>
      <td>NaN</td>
      <td>774.85</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>0.007</td>
      <td>17.25</td>
      <td>17.54</td>
      <td>96.84</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1993-01-01</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1993-01-01</td>
      <td>Centro</td>
      <td>2.58</td>
      <td>1.25</td>
      <td>11.00</td>
      <td>8.50</td>
      <td>18.5</td>
      <td>30.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>17.25</td>
      <td>11.91</td>
      <td>86.94</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1993-01-01</td>
      <td>Noroeste</td>
      <td>0.98</td>
      <td>4.25</td>
      <td>6.75</td>
      <td>11.00</td>
      <td>24.5</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>9.25</td>
      <td>NaN</td>
      <td>17.45</td>
      <td>45.29</td>
      <td>96.84</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1993-01-01</td>
      <td>Suroeste</td>
      <td>1.65</td>
      <td>3.00</td>
      <td>14.25</td>
      <td>17.50</td>
      <td>6.0</td>
      <td>38.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.25</td>
      <td>NaN</td>
      <td>16.65</td>
      <td>15.77</td>
      <td>93.96</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Últimos registros; en ambos se pueden especificar cuántos mostrar</span>
<span class="n">df_pollutants_all</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>pressure</th>
      <th>rainfall</th>
      <th>humidity</th>
      <th>SO2</th>
      <th>solar</th>
      <th>temperature</th>
      <th>velocity</th>
      <th>direction</th>
      <th>valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1542693</th>
      <td>2018-12-31 23:00:00</td>
      <td>Sureste3</td>
      <td>5.97</td>
      <td>58.400002</td>
      <td>11.800000</td>
      <td>70.099998</td>
      <td>13.0</td>
      <td>392.0</td>
      <td>295.0</td>
      <td>732.200012</td>
      <td>0.0</td>
      <td>81.0</td>
      <td>6.8</td>
      <td>0.036</td>
      <td>10.49</td>
      <td>1.5</td>
      <td>3.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1542694</th>
      <td>2018-12-31 23:00:00</td>
      <td>Sur</td>
      <td>1.36</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.0</td>
      <td>8.0</td>
      <td>706.799988</td>
      <td>0.0</td>
      <td>75.0</td>
      <td>10.6</td>
      <td>0.002</td>
      <td>9.73</td>
      <td>2.1</td>
      <td>98.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1542695</th>
      <td>2018-12-31 23:00:00</td>
      <td>Norte2</td>
      <td>3.39</td>
      <td>149.399994</td>
      <td>59.900002</td>
      <td>185.100006</td>
      <td>NaN</td>
      <td>103.0</td>
      <td>NaN</td>
      <td>713.700012</td>
      <td>0.0</td>
      <td>66.0</td>
      <td>9.0</td>
      <td>0.000</td>
      <td>12.26</td>
      <td>3.8</td>
      <td>61.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Muestra de 4 individuos sin reemplazo</span>
<span class="n">df_pollutants_all</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>pressure</th>
      <th>rainfall</th>
      <th>humidity</th>
      <th>SO2</th>
      <th>solar</th>
      <th>temperature</th>
      <th>velocity</th>
      <th>direction</th>
      <th>valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>575395</th>
      <td>2006-02-16 23:00:00</td>
      <td>Sureste</td>
      <td>1.80</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>104.00</td>
      <td>NaN</td>
      <td>718.000000</td>
      <td>0.0</td>
      <td>50.0</td>
      <td>5.6</td>
      <td>0.0</td>
      <td>22.91</td>
      <td>5.877265</td>
      <td>64.391415</td>
      <td>1</td>
    </tr>
    <tr>
      <th>445297</th>
      <td>2003-02-28 19:00:00</td>
      <td>Centro</td>
      <td>1.55</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.5</td>
      <td>60.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.25</td>
      <td>8.930000</td>
      <td>62.820000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>56702</th>
      <td>1994-04-18 12:00:00</td>
      <td>Centro</td>
      <td>0.88</td>
      <td>9.25</td>
      <td>19.5</td>
      <td>27.5</td>
      <td>57.0</td>
      <td>71.25</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.5</td>
      <td>NaN</td>
      <td>25.20</td>
      <td>9.090000</td>
      <td>70.920000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>920570</th>
      <td>2012-05-03 00:00:00</td>
      <td>Centro</td>
      <td>0.55</td>
      <td>1.40</td>
      <td>10.2</td>
      <td>11.6</td>
      <td>18.0</td>
      <td>28.00</td>
      <td>NaN</td>
      <td>710.199985</td>
      <td>0.0</td>
      <td>80.0</td>
      <td>2.8</td>
      <td>0.0</td>
      <td>24.42</td>
      <td>5.000000</td>
      <td>10.200000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Los datos de <code class="docutils literal notranslate"><span class="pre">df_pollutants_all</span></code> van de 1993 a 2018. En un archivo XLSX se encuentran los datos de 2019.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;../data/2019_pollutants.xlsx&quot;</span><span class="p">)</span>
<span class="n">df_pollutants_2019</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CE-MET</th>
      <th>Unnamed: 1</th>
      <th>SURESTE</th>
      <th>SURESTE.1</th>
      <th>SURESTE.2</th>
      <th>SURESTE.3</th>
      <th>SURESTE.4</th>
      <th>SURESTE.5</th>
      <th>SURESTE.6</th>
      <th>SURESTE.7</th>
      <th>...</th>
      <th>NORTE 2.7</th>
      <th>NORTE 2.8</th>
      <th>NORTE 2.9</th>
      <th>NORTE 2.10</th>
      <th>NORTE 2.11</th>
      <th>NORTE 2.12</th>
      <th>NORTE 2.13</th>
      <th>NORTE 2.14</th>
      <th>Unnamed: 209</th>
      <th>Unnamed: 210</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Date - Time</td>
      <td>NaT</td>
      <td>CO</td>
      <td>NO</td>
      <td>NO2</td>
      <td>NOX</td>
      <td>O3</td>
      <td>PM10</td>
      <td>PM2.5</td>
      <td>PRS</td>
      <td>...</td>
      <td>PRS</td>
      <td>RAINF</td>
      <td>RH</td>
      <td>SO2</td>
      <td>SR</td>
      <td>TOUT</td>
      <td>WSR</td>
      <td>WDR</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaT</td>
      <td>ppm</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ug/m3</td>
      <td>ug/m3</td>
      <td>mmhg</td>
      <td>...</td>
      <td>mmhg</td>
      <td>mm/hr</td>
      <td>%</td>
      <td>ppb</td>
      <td>KW/m2</td>
      <td>degC</td>
      <td>KMPH</td>
      <td>DEG</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 00:00:00</td>
      <td>2019-01-01 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>215.45</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 01:00:00</td>
      <td>2019-01-01 01:00:00</td>
      <td>2.74</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>242</td>
      <td>NaN</td>
      <td>725.8</td>
      <td>...</td>
      <td>713.5</td>
      <td>0</td>
      <td>77</td>
      <td>11.6</td>
      <td>0</td>
      <td>10.41</td>
      <td>2.2</td>
      <td>23</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 02:00:00</td>
      <td>2019-01-01 02:00:00</td>
      <td>3.01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>281</td>
      <td>NaN</td>
      <td>725.7</td>
      <td>...</td>
      <td>713.3</td>
      <td>0</td>
      <td>74</td>
      <td>26.6</td>
      <td>0</td>
      <td>10.47</td>
      <td>2.9</td>
      <td>269</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8758</th>
      <td>2019-12-31 20:00:00</td>
      <td>2019-12-31 20:00:00</td>
      <td>1.47</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>22</td>
      <td>25</td>
      <td>23.84</td>
      <td>735.5</td>
      <td>...</td>
      <td>715.6</td>
      <td>0</td>
      <td>90</td>
      <td>19.1</td>
      <td>0</td>
      <td>10.73</td>
      <td>7.4</td>
      <td>109</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8759</th>
      <td>2019-12-31 21:00:00</td>
      <td>2019-12-31 21:00:00</td>
      <td>1.59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23</td>
      <td>37</td>
      <td>31.97</td>
      <td>735.9</td>
      <td>...</td>
      <td>716</td>
      <td>0</td>
      <td>90</td>
      <td>19.9</td>
      <td>0</td>
      <td>10.89</td>
      <td>5.7</td>
      <td>86</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8760</th>
      <td>2019-12-31 22:00:00</td>
      <td>2019-12-31 22:00:00</td>
      <td>1.76</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16</td>
      <td>46</td>
      <td>NaN</td>
      <td>735.9</td>
      <td>...</td>
      <td>715.9</td>
      <td>0</td>
      <td>91</td>
      <td>21.8</td>
      <td>0</td>
      <td>10.93</td>
      <td>4.6</td>
      <td>107</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8761</th>
      <td>2019-12-31 23:00:00</td>
      <td>2019-12-31 23:00:00</td>
      <td>1.69</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20</td>
      <td>60</td>
      <td>55.31</td>
      <td>735.7</td>
      <td>...</td>
      <td>715.8</td>
      <td>0</td>
      <td>91</td>
      <td>20.7</td>
      <td>0</td>
      <td>11.05</td>
      <td>5.6</td>
      <td>85</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8762</th>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>8763 rows × 211 columns</p>
</div></div></div>
</div>
<p>Esta base de datos tiene la información organizada de una manera muy distinta a como aparece en <code class="docutils literal notranslate"><span class="pre">df_pollutants_all</span></code>. Las primeras dos columnas muetran la fecha del registro. Las siguientes llevan el nombre de la estación donde se hace el resgistro, seguida por un número entero. La primera fila muestra, para cada una de esas estaciones, la variable que están registrando. Hay que lidiar con todo eso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Columnas</span>
<span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;CE-MET&#39;, &#39;Unnamed: 1&#39;, &#39;SURESTE&#39;, &#39;SURESTE.1&#39;, &#39;SURESTE.2&#39;,
       &#39;SURESTE.3&#39;, &#39;SURESTE.4&#39;, &#39;SURESTE.5&#39;, &#39;SURESTE.6&#39;, &#39;SURESTE.7&#39;,
       ...
       &#39;NORTE 2.7&#39;, &#39;NORTE 2.8&#39;, &#39;NORTE 2.9&#39;, &#39;NORTE 2.10&#39;, &#39;NORTE 2.11&#39;,
       &#39;NORTE 2.12&#39;, &#39;NORTE 2.13&#39;, &#39;NORTE 2.14&#39;, &#39;Unnamed: 209&#39;,
       &#39;Unnamed: 210&#39;],
      dtype=&#39;object&#39;, length=211)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Columnas que contienen Unnamed</span>
<span class="n">unnamed</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;Unnamed&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>
<span class="n">unnamed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Unnamed: 1&#39;,
 &#39;Unnamed: 17&#39;,
 &#39;Unnamed: 33&#39;,
 &#39;Unnamed: 49&#39;,
 &#39;Unnamed: 65&#39;,
 &#39;Unnamed: 81&#39;,
 &#39;Unnamed: 97&#39;,
 &#39;Unnamed: 113&#39;,
 &#39;Unnamed: 129&#39;,
 &#39;Unnamed: 145&#39;,
 &#39;Unnamed: 161&#39;,
 &#39;Unnamed: 177&#39;,
 &#39;Unnamed: 193&#39;,
 &#39;Unnamed: 209&#39;,
 &#39;Unnamed: 210&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtro para mostrar sólo columnas Unnamed</span>
<span class="n">df_pollutants_2019</span><span class="p">[</span><span class="n">unnamed</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 1</th>
      <th>Unnamed: 17</th>
      <th>Unnamed: 33</th>
      <th>Unnamed: 49</th>
      <th>Unnamed: 65</th>
      <th>Unnamed: 81</th>
      <th>Unnamed: 97</th>
      <th>Unnamed: 113</th>
      <th>Unnamed: 129</th>
      <th>Unnamed: 145</th>
      <th>Unnamed: 161</th>
      <th>Unnamed: 177</th>
      <th>Unnamed: 193</th>
      <th>Unnamed: 209</th>
      <th>Unnamed: 210</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 01:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 02:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8758</th>
      <td>2019-12-31 20:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8759</th>
      <td>2019-12-31 21:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8760</th>
      <td>2019-12-31 22:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8761</th>
      <td>2019-12-31 23:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8762</th>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>8763 rows × 15 columns</p>
</div></div></div>
</div>
<p>Se comparan los valores entre la columna con índice 0 y la 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selector de filas y columnas por índice</span>
<span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># [filas : columnas]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CE-MET</th>
      <th>Unnamed: 1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Date - Time</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 00:00:00</td>
      <td>2019-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 01:00:00</td>
      <td>2019-01-01 01:00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 02:00:00</td>
      <td>2019-01-01 02:00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8758</th>
      <td>2019-12-31 20:00:00</td>
      <td>2019-12-31 20:00:00</td>
    </tr>
    <tr>
      <th>8759</th>
      <td>2019-12-31 21:00:00</td>
      <td>2019-12-31 21:00:00</td>
    </tr>
    <tr>
      <th>8760</th>
      <td>2019-12-31 22:00:00</td>
      <td>2019-12-31 22:00:00</td>
    </tr>
    <tr>
      <th>8761</th>
      <td>2019-12-31 23:00:00</td>
      <td>2019-12-31 23:00:00</td>
    </tr>
    <tr>
      <th>8762</th>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
  </tbody>
</table>
<p>8763 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filas que son diferentes entre las columnas 0 y 1</span>
<span class="n">filtro</span> <span class="o">=</span> <span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">filtro</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        True
1        True
2       False
3       False
4       False
        ...  
8758    False
8759    False
8760    False
8761    False
8762     True
Length: 8763, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtro a partir de comparación booleana</span>
<span class="n">df_pollutants_2019</span><span class="p">[</span><span class="n">filtro</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CE-MET</th>
      <th>Unnamed: 1</th>
      <th>SURESTE</th>
      <th>SURESTE.1</th>
      <th>SURESTE.2</th>
      <th>SURESTE.3</th>
      <th>SURESTE.4</th>
      <th>SURESTE.5</th>
      <th>SURESTE.6</th>
      <th>SURESTE.7</th>
      <th>...</th>
      <th>NORTE 2.7</th>
      <th>NORTE 2.8</th>
      <th>NORTE 2.9</th>
      <th>NORTE 2.10</th>
      <th>NORTE 2.11</th>
      <th>NORTE 2.12</th>
      <th>NORTE 2.13</th>
      <th>NORTE 2.14</th>
      <th>Unnamed: 209</th>
      <th>Unnamed: 210</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Date - Time</td>
      <td>NaT</td>
      <td>CO</td>
      <td>NO</td>
      <td>NO2</td>
      <td>NOX</td>
      <td>O3</td>
      <td>PM10</td>
      <td>PM2.5</td>
      <td>PRS</td>
      <td>...</td>
      <td>PRS</td>
      <td>RAINF</td>
      <td>RH</td>
      <td>SO2</td>
      <td>SR</td>
      <td>TOUT</td>
      <td>WSR</td>
      <td>WDR</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaT</td>
      <td>ppm</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ug/m3</td>
      <td>ug/m3</td>
      <td>mmhg</td>
      <td>...</td>
      <td>mmhg</td>
      <td>mm/hr</td>
      <td>%</td>
      <td>ppb</td>
      <td>KW/m2</td>
      <td>degC</td>
      <td>KMPH</td>
      <td>DEG</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6312</th>
      <td>NaN</td>
      <td>2019-09-20 22:00:00</td>
      <td>0.52</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18</td>
      <td>NaN</td>
      <td>8.03</td>
      <td>724.7</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8762</th>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 211 columns</p>
</div></div></div>
</div>
<p>Se copia la fila <span class="math notranslate nohighlight">\(6312\)</span> de la columna con índice 1 a la 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6312</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2019-09-20 22:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>Antes de modificar una tabla, recomiendo hacer una copia de la misma.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copiar dataframe</span>
<span class="n">df_pollutants_2019_mod</span> <span class="o">=</span> <span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copiar valores por posición</span>
<span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6312</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6312</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6312</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CE-MET        2019-09-20 22:00:00
Unnamed: 1    2019-09-20 22:00:00
Name: 6312, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># No nulos por columna</span>
<span class="n">df_pollutants_2019_mod</span><span class="p">[</span><span class="n">unnamed</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unnamed: 1      8760
Unnamed: 17        0
Unnamed: 33        0
Unnamed: 49        0
Unnamed: 65        0
Unnamed: 81        0
Unnamed: 97        0
Unnamed: 113       0
Unnamed: 129       0
Unnamed: 145       0
Unnamed: 161       0
Unnamed: 177       0
Unnamed: 193       0
Unnamed: 209       0
Unnamed: 210       6
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Se eliminan las columnas con Unnamed</span>
<span class="n">df_pollutants_2019_mod</span> <span class="o">=</span> <span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">unnamed</span><span class="p">)</span>
<span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CE-MET</th>
      <th>SURESTE</th>
      <th>SURESTE.1</th>
      <th>SURESTE.2</th>
      <th>SURESTE.3</th>
      <th>SURESTE.4</th>
      <th>SURESTE.5</th>
      <th>SURESTE.6</th>
      <th>SURESTE.7</th>
      <th>SURESTE.8</th>
      <th>...</th>
      <th>NORTE 2.5</th>
      <th>NORTE 2.6</th>
      <th>NORTE 2.7</th>
      <th>NORTE 2.8</th>
      <th>NORTE 2.9</th>
      <th>NORTE 2.10</th>
      <th>NORTE 2.11</th>
      <th>NORTE 2.12</th>
      <th>NORTE 2.13</th>
      <th>NORTE 2.14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Date - Time</td>
      <td>CO</td>
      <td>NO</td>
      <td>NO2</td>
      <td>NOX</td>
      <td>O3</td>
      <td>PM10</td>
      <td>PM2.5</td>
      <td>PRS</td>
      <td>RAINF</td>
      <td>...</td>
      <td>PM10</td>
      <td>PM2.5</td>
      <td>PRS</td>
      <td>RAINF</td>
      <td>RH</td>
      <td>SO2</td>
      <td>SR</td>
      <td>TOUT</td>
      <td>WSR</td>
      <td>WDR</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>ppm</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ppb</td>
      <td>ug/m3</td>
      <td>ug/m3</td>
      <td>mmhg</td>
      <td>mm/hr</td>
      <td>...</td>
      <td>ug/m3</td>
      <td>ug/m3</td>
      <td>mmhg</td>
      <td>mm/hr</td>
      <td>%</td>
      <td>ppb</td>
      <td>KW/m2</td>
      <td>degC</td>
      <td>KMPH</td>
      <td>DEG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>215.45</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 01:00:00</td>
      <td>2.74</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>242</td>
      <td>NaN</td>
      <td>725.8</td>
      <td>0</td>
      <td>...</td>
      <td>413</td>
      <td>343</td>
      <td>713.5</td>
      <td>0</td>
      <td>77</td>
      <td>11.6</td>
      <td>0</td>
      <td>10.41</td>
      <td>2.2</td>
      <td>23</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 02:00:00</td>
      <td>3.01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>281</td>
      <td>NaN</td>
      <td>725.7</td>
      <td>0</td>
      <td>...</td>
      <td>367</td>
      <td>NaN</td>
      <td>713.3</td>
      <td>0</td>
      <td>74</td>
      <td>26.6</td>
      <td>0</td>
      <td>10.47</td>
      <td>2.9</td>
      <td>269</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 196 columns</p>
</div></div></div>
</div>
<p>La fila 1 sólo aporta la unidad en que se mide la variable de los datos, así que se elimina.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Elimina fila por índice</span>
<span class="n">df_pollutants_2019_mod</span> <span class="o">=</span> <span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CE-MET</th>
      <th>SURESTE</th>
      <th>SURESTE.1</th>
      <th>SURESTE.2</th>
      <th>SURESTE.3</th>
      <th>SURESTE.4</th>
      <th>SURESTE.5</th>
      <th>SURESTE.6</th>
      <th>SURESTE.7</th>
      <th>SURESTE.8</th>
      <th>...</th>
      <th>NORTE 2.5</th>
      <th>NORTE 2.6</th>
      <th>NORTE 2.7</th>
      <th>NORTE 2.8</th>
      <th>NORTE 2.9</th>
      <th>NORTE 2.10</th>
      <th>NORTE 2.11</th>
      <th>NORTE 2.12</th>
      <th>NORTE 2.13</th>
      <th>NORTE 2.14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Date - Time</td>
      <td>CO</td>
      <td>NO</td>
      <td>NO2</td>
      <td>NOX</td>
      <td>O3</td>
      <td>PM10</td>
      <td>PM2.5</td>
      <td>PRS</td>
      <td>RAINF</td>
      <td>...</td>
      <td>PM10</td>
      <td>PM2.5</td>
      <td>PRS</td>
      <td>RAINF</td>
      <td>RH</td>
      <td>SO2</td>
      <td>SR</td>
      <td>TOUT</td>
      <td>WSR</td>
      <td>WDR</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>215.45</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 01:00:00</td>
      <td>2.74</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>242</td>
      <td>NaN</td>
      <td>725.8</td>
      <td>0</td>
      <td>...</td>
      <td>413</td>
      <td>343</td>
      <td>713.5</td>
      <td>0</td>
      <td>77</td>
      <td>11.6</td>
      <td>0</td>
      <td>10.41</td>
      <td>2.2</td>
      <td>23</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 02:00:00</td>
      <td>3.01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>281</td>
      <td>NaN</td>
      <td>725.7</td>
      <td>0</td>
      <td>...</td>
      <td>367</td>
      <td>NaN</td>
      <td>713.3</td>
      <td>0</td>
      <td>74</td>
      <td>26.6</td>
      <td>0</td>
      <td>10.47</td>
      <td>2.9</td>
      <td>269</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-01-01 03:00:00</td>
      <td>2.01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4</td>
      <td>398</td>
      <td>235.33</td>
      <td>725.7</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>756</td>
      <td>713.2</td>
      <td>0</td>
      <td>71</td>
      <td>27.3</td>
      <td>0</td>
      <td>10.21</td>
      <td>3.8</td>
      <td>252</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 196 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separación de cadena por .</span>
<span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;SURESTE&#39;, &#39;1&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="c1"># 2: A lista</span>
    <span class="nb">set</span><span class="p">(</span> <span class="c1"># 1: Sin repetidos</span>
        <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_pollutants_2019_mod</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span> <span class="c1"># 0: Todos los nombres de columna antes del punto</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">columnas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Sureste&#39;,
 &#39;Noreste&#39;,
 &#39;Noreste2&#39;,
 &#39;Sureste2&#39;,
 &#39;Noroeste&#39;,
 &#39;Norte 2&#39;,
 &#39;Ce-Met&#39;,
 &#39;Sureste 3&#39;,
 &#39;Noroeste 2&#39;,
 &#39;Suroeste&#39;,
 &#39;Centro&#39;,
 &#39;Norte&#39;,
 &#39;Suroeste2&#39;,
 &#39;Sur&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># De ahí se eliminan la columna del tiempo</span>
<span class="n">columnas</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;Ce-Met&#39;</span><span class="p">)</span>
<span class="nb">sorted</span><span class="p">(</span><span class="n">columnas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Centro&#39;,
 &#39;Noreste&#39;,
 &#39;Noreste2&#39;,
 &#39;Noroeste&#39;,
 &#39;Noroeste 2&#39;,
 &#39;Norte&#39;,
 &#39;Norte 2&#39;,
 &#39;Sur&#39;,
 &#39;Sureste&#39;,
 &#39;Sureste 3&#39;,
 &#39;Sureste2&#39;,
 &#39;Suroeste&#39;,
 &#39;Suroeste2&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Se crea una base de datos vacía</span>
<span class="n">df_pollutants_2019_def</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columnas</span><span class="p">:</span>
  <span class="c1"># Devuelve todas las columnas con el nombre de la estacion</span>
  <span class="n">estacion</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_pollutants_2019</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()]</span>
  <span class="n">estacion</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;CE-MET&#39;</span><span class="p">)</span>
  <span class="c1"># Se toman todas las columnas de esa estación</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">df_pollutants_2019</span><span class="p">[</span><span class="n">estacion</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="c1"># Se ponen como encabezados las variables</span>
  <span class="n">t</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="c1"># Se quita la fila de encabezados que fue promovida</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="c1"># y la de unidades de medida</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># Se agrega la estacion y se eliminan espacios entre números y nombre</span>
  <span class="n">t</span><span class="p">[</span><span class="s1">&#39;station&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
  <span class="c1"># Se reinician los índices</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="c1"># Se agregan al df nuevo</span>
  <span class="n">df_pollutants_2019_def</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">df_pollutants_2019_def</span><span class="p">],</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df_pollutants_2019_def</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2.5</th>
      <th>PRS</th>
      <th>RAINF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>TOUT</th>
      <th>WSR</th>
      <th>WDR</th>
      <th>Date - Time</th>
      <th>station</th>
      <th>WDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-01-01 00:00:00</td>
      <td>Sur</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37</td>
      <td>8</td>
      <td>706.4</td>
      <td>0</td>
      <td>73</td>
      <td>10.9</td>
      <td>0.002</td>
      <td>9.2</td>
      <td>2</td>
      <td>122</td>
      <td>2019-01-01 01:00:00</td>
      <td>Sur</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.34</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>7</td>
      <td>706.3</td>
      <td>0</td>
      <td>74</td>
      <td>10.4</td>
      <td>0.002</td>
      <td>8.54</td>
      <td>1.7</td>
      <td>24</td>
      <td>2019-01-01 02:00:00</td>
      <td>Sur</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.56</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>10</td>
      <td>706.2</td>
      <td>0</td>
      <td>76</td>
      <td>10.7</td>
      <td>0.002</td>
      <td>8.05</td>
      <td>1.7</td>
      <td>101</td>
      <td>2019-01-01 03:00:00</td>
      <td>Sur</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49</td>
      <td>11</td>
      <td>706.1</td>
      <td>0</td>
      <td>72</td>
      <td>11</td>
      <td>0.002</td>
      <td>7.93</td>
      <td>1.7</td>
      <td>187</td>
      <td>2019-01-01 04:00:00</td>
      <td>Sur</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>113888</th>
      <td>1.47</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>22</td>
      <td>25</td>
      <td>23.84</td>
      <td>735.5</td>
      <td>0</td>
      <td>96</td>
      <td>6.2</td>
      <td>0.01</td>
      <td>10.61</td>
      <td>17.2</td>
      <td>NaN</td>
      <td>2019-12-31 20:00:00</td>
      <td>Sureste</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113889</th>
      <td>1.59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23</td>
      <td>37</td>
      <td>31.97</td>
      <td>735.9</td>
      <td>0</td>
      <td>96</td>
      <td>5.7</td>
      <td>0.01</td>
      <td>10.75</td>
      <td>11.7</td>
      <td>NaN</td>
      <td>2019-12-31 21:00:00</td>
      <td>Sureste</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113890</th>
      <td>1.76</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16</td>
      <td>46</td>
      <td>NaN</td>
      <td>735.9</td>
      <td>0</td>
      <td>96</td>
      <td>5.6</td>
      <td>0.01</td>
      <td>10.85</td>
      <td>7.5</td>
      <td>NaN</td>
      <td>2019-12-31 22:00:00</td>
      <td>Sureste</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113891</th>
      <td>1.69</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20</td>
      <td>60</td>
      <td>55.31</td>
      <td>735.7</td>
      <td>0.01</td>
      <td>96</td>
      <td>5.4</td>
      <td>0.01</td>
      <td>10.96</td>
      <td>7.4</td>
      <td>NaN</td>
      <td>2019-12-31 23:00:00</td>
      <td>Sureste</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113892</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sureste</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>113893 rows × 18 columns</p>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">WDV</span></code> y <code class="docutils literal notranslate"><span class="pre">WDR</span></code> miden grados, por lo que se pueden combinar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># WDV no es nulo mientras WDR es nulo</span>
<span class="n">filtro</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">WDV</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">WDR</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
<span class="c1"># Cantidad de True</span>
<span class="n">filtro</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31165
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copiar en WDR los valores de WDV</span>
<span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">filtro</span><span class="p">,</span> <span class="s1">&#39;WDR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">filtro</span><span class="p">,</span> <span class="s1">&#39;WDV&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar columna en sitio</span>
<span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;WDV&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2.5</th>
      <th>PRS</th>
      <th>RAINF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>TOUT</th>
      <th>WSR</th>
      <th>WDR</th>
      <th>Date - Time</th>
      <th>station</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-01-01 00:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37</td>
      <td>8</td>
      <td>706.4</td>
      <td>0</td>
      <td>73</td>
      <td>10.9</td>
      <td>0.002</td>
      <td>9.2</td>
      <td>2</td>
      <td>122</td>
      <td>2019-01-01 01:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.34</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>7</td>
      <td>706.3</td>
      <td>0</td>
      <td>74</td>
      <td>10.4</td>
      <td>0.002</td>
      <td>8.54</td>
      <td>1.7</td>
      <td>24</td>
      <td>2019-01-01 02:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.56</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>10</td>
      <td>706.2</td>
      <td>0</td>
      <td>76</td>
      <td>10.7</td>
      <td>0.002</td>
      <td>8.05</td>
      <td>1.7</td>
      <td>101</td>
      <td>2019-01-01 03:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49</td>
      <td>11</td>
      <td>706.1</td>
      <td>0</td>
      <td>72</td>
      <td>11</td>
      <td>0.002</td>
      <td>7.93</td>
      <td>1.7</td>
      <td>187</td>
      <td>2019-01-01 04:00:00</td>
      <td>Sur</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se emparejan los nombres de columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;CO&#39;, &#39;NO&#39;, &#39;NO2&#39;, &#39;NOX&#39;, &#39;O3&#39;, &#39;PM10&#39;, &#39;PM2.5&#39;, &#39;PRS&#39;, &#39;RAINF&#39;, &#39;RH&#39;,
       &#39;SO2&#39;, &#39;SR&#39;, &#39;TOUT&#39;, &#39;WSR&#39;, &#39;WDR&#39;, &#39;Date - Time&#39;, &#39;station&#39;],
      dtype=&#39;object&#39;, name=0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_all</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;timestamp&#39;, &#39;station&#39;, &#39;CO&#39;, &#39;NO&#39;, &#39;NO2&#39;, &#39;NOX&#39;, &#39;O3&#39;, &#39;PM10&#39;, &#39;PM2_5&#39;,
       &#39;pressure&#39;, &#39;rainfall&#39;, &#39;humidity&#39;, &#39;SO2&#39;, &#39;solar&#39;, &#39;temperature&#39;,
       &#39;velocity&#39;, &#39;direction&#39;, &#39;valid&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_all</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;PM10&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BP&#39;</span><span class="p">,</span> <span class="s1">&#39;RF&#39;</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span> <span class="s1">&#39;SO2&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span>
    <span class="s1">&#39;WV&#39;</span><span class="p">,</span> <span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="s1">&#39;valid&#39;</span>
<span class="p">]</span>
<span class="n">df_pollutants_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>BP</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WV</th>
      <th>WD</th>
      <th>valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1993-01-01</td>
      <td>Sureste</td>
      <td>0.95</td>
      <td>0.25</td>
      <td>5.75</td>
      <td>6.75</td>
      <td>19.0</td>
      <td>41.0</td>
      <td>NaN</td>
      <td>774.85</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>0.007</td>
      <td>17.25</td>
      <td>17.54</td>
      <td>96.84</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1993-01-01</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1993-01-01</td>
      <td>Centro</td>
      <td>2.58</td>
      <td>1.25</td>
      <td>11.00</td>
      <td>8.50</td>
      <td>18.5</td>
      <td>30.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>17.25</td>
      <td>11.91</td>
      <td>86.94</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1993-01-01</td>
      <td>Noroeste</td>
      <td>0.98</td>
      <td>4.25</td>
      <td>6.75</td>
      <td>11.00</td>
      <td>24.5</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>9.25</td>
      <td>NaN</td>
      <td>17.45</td>
      <td>45.29</td>
      <td>96.84</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1993-01-01</td>
      <td>Suroeste</td>
      <td>1.65</td>
      <td>3.00</td>
      <td>14.25</td>
      <td>17.50</td>
      <td>6.0</td>
      <td>38.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.25</td>
      <td>NaN</td>
      <td>16.65</td>
      <td>15.77</td>
      <td>93.96</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;PM10&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span> <span class="s1">&#39;BP&#39;</span><span class="p">,</span> <span class="s1">&#39;RF&#39;</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span>
       <span class="s1">&#39;SO2&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;WV&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;WD&#39;</span>
<span class="p">]</span>
<span class="n">df_pollutants_2019_def</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>BP</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WV</th>
      <th>timestamp</th>
      <th>station</th>
      <th>WD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-01-01 00:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37</td>
      <td>8</td>
      <td>706.4</td>
      <td>0</td>
      <td>73</td>
      <td>10.9</td>
      <td>0.002</td>
      <td>9.2</td>
      <td>2</td>
      <td>122</td>
      <td>2019-01-01 01:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.34</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>7</td>
      <td>706.3</td>
      <td>0</td>
      <td>74</td>
      <td>10.4</td>
      <td>0.002</td>
      <td>8.54</td>
      <td>1.7</td>
      <td>24</td>
      <td>2019-01-01 02:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.56</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>10</td>
      <td>706.2</td>
      <td>0</td>
      <td>76</td>
      <td>10.7</td>
      <td>0.002</td>
      <td>8.05</td>
      <td>1.7</td>
      <td>101</td>
      <td>2019-01-01 03:00:00</td>
      <td>Sur</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49</td>
      <td>11</td>
      <td>706.1</td>
      <td>0</td>
      <td>72</td>
      <td>11</td>
      <td>0.002</td>
      <td>7.93</td>
      <td>1.7</td>
      <td>187</td>
      <td>2019-01-01 04:00:00</td>
      <td>Sur</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unir dos dataframes</span>
<span class="n">df_pollutants</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_pollutants_all</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">]),</span> <span class="n">df_pollutants_2019_def</span><span class="p">])</span>
<span class="n">df_pollutants</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>BP</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WV</th>
      <th>WD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1993-01-01 00:00:00</td>
      <td>Sureste</td>
      <td>0.95</td>
      <td>0.25</td>
      <td>5.75</td>
      <td>6.75</td>
      <td>19.0</td>
      <td>41.0</td>
      <td>NaN</td>
      <td>774.85</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.5</td>
      <td>0.007</td>
      <td>17.25</td>
      <td>17.54</td>
      <td>96.84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1993-01-01 00:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1993-01-01 00:00:00</td>
      <td>Centro</td>
      <td>2.58</td>
      <td>1.25</td>
      <td>11.0</td>
      <td>8.5</td>
      <td>18.5</td>
      <td>30.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>17.25</td>
      <td>11.91</td>
      <td>86.94</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1993-01-01 00:00:00</td>
      <td>Noroeste</td>
      <td>0.98</td>
      <td>4.25</td>
      <td>6.75</td>
      <td>11.0</td>
      <td>24.5</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>9.25</td>
      <td>NaN</td>
      <td>17.45</td>
      <td>45.29</td>
      <td>96.84</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1993-01-01 00:00:00</td>
      <td>Suroeste</td>
      <td>1.65</td>
      <td>3.0</td>
      <td>14.25</td>
      <td>17.5</td>
      <td>6.0</td>
      <td>38.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.25</td>
      <td>NaN</td>
      <td>16.65</td>
      <td>15.77</td>
      <td>93.96</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Guardar registros con tiempo</span>
<span class="n">df_pollutants</span> <span class="o">=</span> <span class="n">df_pollutants</span><span class="p">[</span><span class="o">~</span><span class="n">df_pollutants</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convertir a tipo datetime</span>
<span class="n">df_pollutants</span><span class="p">[</span><span class="n">df_pollutants</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_pollutants</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">37</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Convertir a tipo datetime</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">df_pollutants</span><span class="p">[</span><span class="n">df_pollutants</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_pollutants</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ds\Lib\site-packages\pandas\core\tools\datetimes.py:1064,</span> in <span class="ni">to_datetime</span><span class="nt">(arg, errors, dayfirst, yearfirst, utc, format, exact, unit, infer_datetime_format, origin, cache)</span>
<span class="g g-Whitespace">   </span><span class="mi">1062</span>             <span class="n">result</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1063</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">ABCSeries</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1064</span>     <span class="n">cache_array</span> <span class="o">=</span> <span class="n">_maybe_cache</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="n">cache</span><span class="p">,</span> <span class="n">convert_listlike</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1065</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">cache_array</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1066</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">cache_array</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ds\Lib\site-packages\pandas\core\tools\datetimes.py:229,</span> in <span class="ni">_maybe_cache</span><span class="nt">(arg, format, cache, convert_listlike)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span> <span class="n">unique_dates</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_dates</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">229</span>     <span class="n">cache_dates</span> <span class="o">=</span> <span class="n">convert_listlike</span><span class="p">(</span><span class="n">unique_dates</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>     <span class="c1"># GH#45319</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>     <span class="k">try</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ds\Lib\site-packages\pandas\core\tools\datetimes.py:438,</span> in <span class="ni">_convert_listlike_datetimes</span><span class="nt">(arg, format, name, tz, unit, errors, infer_datetime_format, dayfirst, yearfirst, exact)</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span> <span class="k">assert</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">infer_datetime_format</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span> <span class="n">utc</span> <span class="o">=</span> <span class="n">tz</span> <span class="o">==</span> <span class="s2">&quot;utc&quot;</span>
<span class="ne">--&gt; </span><span class="mi">438</span> <span class="n">result</span><span class="p">,</span> <span class="n">tz_parsed</span> <span class="o">=</span> <span class="n">objects_to_datetime64ns</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="n">arg</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span>     <span class="n">dayfirst</span><span class="o">=</span><span class="n">dayfirst</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>     <span class="n">yearfirst</span><span class="o">=</span><span class="n">yearfirst</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span>     <span class="n">utc</span><span class="o">=</span><span class="n">utc</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span>     <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>     <span class="n">require_iso8601</span><span class="o">=</span><span class="n">require_iso8601</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">445</span>     <span class="n">allow_object</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span> <span class="k">if</span> <span class="n">tz_parsed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">449</span>     <span class="c1"># We can take a shortcut since the datetime64 numpy array</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>     <span class="c1"># is in UTC</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span>     <span class="n">dta</span> <span class="o">=</span> <span class="n">DatetimeArray</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tz_to_dtype</span><span class="p">(</span><span class="n">tz_parsed</span><span class="p">))</span>

<span class="nn">File ~\miniconda3\envs\ds\Lib\site-packages\pandas\core\arrays\datetimes.py:2177,</span> in <span class="ni">objects_to_datetime64ns</span><span class="nt">(data, dayfirst, yearfirst, utc, errors, require_iso8601, allow_object, allow_mixed)</span>
<span class="g g-Whitespace">   </span><span class="mi">2175</span> <span class="n">order</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;F&quot;</span> <span class="k">if</span> <span class="n">flags</span><span class="o">.</span><span class="n">f_contiguous</span> <span class="k">else</span> <span class="s2">&quot;C&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2176</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2177</span>     <span class="n">result</span><span class="p">,</span> <span class="n">tz_parsed</span> <span class="o">=</span> <span class="n">tslib</span><span class="o">.</span><span class="n">array_to_datetime</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2178</span>         <span class="n">data</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">2179</span>         <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2180</span>         <span class="n">utc</span><span class="o">=</span><span class="n">utc</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2181</span>         <span class="n">dayfirst</span><span class="o">=</span><span class="n">dayfirst</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2182</span>         <span class="n">yearfirst</span><span class="o">=</span><span class="n">yearfirst</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2183</span>         <span class="n">require_iso8601</span><span class="o">=</span><span class="n">require_iso8601</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2184</span>         <span class="n">allow_mixed</span><span class="o">=</span><span class="n">allow_mixed</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2185</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2186</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2187</span> <span class="k">except</span> <span class="ne">OverflowError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2188</span>     <span class="c1"># Exception is raised when a part of date is greater than 32 bit signed int</span>

<span class="nn">File ~\miniconda3\envs\ds\Lib\site-packages\pandas\_libs\tslib.pyx:427,</span> in <span class="ni">pandas._libs.tslib.array_to_datetime</span><span class="nt">()</span>

<span class="nn">File ~\miniconda3\envs\ds\Lib\site-packages\pandas\_libs\tslib.pyx:698,</span> in <span class="ni">pandas._libs.tslib.array_to_datetime</span><span class="nt">()</span>

<span class="ne">ValueError</span>: mixed datetimes and integers in passed array
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Primer y último registro</span>
<span class="n">df_pollutants</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>BP</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WV</th>
      <th>WD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1993-01-01 00:00:00</td>
      <td>Sureste</td>
      <td>0.95</td>
      <td>0.25</td>
      <td>5.75</td>
      <td>6.75</td>
      <td>19.0</td>
      <td>41.0</td>
      <td>NaN</td>
      <td>774.85</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.5</td>
      <td>0.007</td>
      <td>17.25</td>
      <td>17.54</td>
      <td>96.84</td>
    </tr>
    <tr>
      <th>113891</th>
      <td>2019-12-31 23:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>86</td>
      <td>NaN</td>
      <td>722</td>
      <td>NaN</td>
      <td>96</td>
      <td>1.5</td>
      <td>0</td>
      <td>10.73</td>
      <td>6.7</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Valores fuera de rango</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_def</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>$\text{PM}_{10}$</td>
      <td>2.00</td>
      <td>850.0</td>
      <td>$\mu\text{gr}$ / $\text{m}^3$</td>
    </tr>
    <tr>
      <th>1</th>
      <td>$\text{PM}_{2.5}$</td>
      <td>2.00</td>
      <td>850.0</td>
      <td>$\mu\text{gr}$ / $\text{m}^3$</td>
    </tr>
    <tr>
      <th>2</th>
      <td>$\text{O}_3$</td>
      <td>1.00</td>
      <td>200.0</td>
      <td>ppb</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NO</td>
      <td>1.00</td>
      <td>350.0</td>
      <td>ppb</td>
    </tr>
    <tr>
      <th>4</th>
      <td>$\text{NO}_2$</td>
      <td>1.00</td>
      <td>150.0</td>
      <td>ppb</td>
    </tr>
    <tr>
      <th>5</th>
      <td>$\text{NO}_X$</td>
      <td>1.00</td>
      <td>350.0</td>
      <td>ppb</td>
    </tr>
    <tr>
      <th>6</th>
      <td>$\text{SO}_2$</td>
      <td>1.00</td>
      <td>200.0</td>
      <td>ppb</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CO</td>
      <td>0.05</td>
      <td>15.0</td>
      <td>ppm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Temperature</td>
      <td>-15.00</td>
      <td>50.0</td>
      <td>C</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Relative humidity</td>
      <td>0.00</td>
      <td>100.0</td>
      <td>%</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Barometric pressure</td>
      <td>650.00</td>
      <td>750.0</td>
      <td>mmHg</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Solar radiation</td>
      <td>0.00</td>
      <td>1.2</td>
      <td>Langley / h</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Rainfall</td>
      <td>0.00</td>
      <td>inf</td>
      <td>mm / h</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Wind velocity</td>
      <td>0.00</td>
      <td>60.0</td>
      <td>Km / h</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Wind direction</td>
      <td>0.00</td>
      <td>360.0</td>
      <td>Azimutales</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nombre de variables de sensores</span>
<span class="n">sensor_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PM10&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span><span class="s1">&#39;SO2&#39;</span><span class="p">,</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span> <span class="s1">&#39;BP&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;RF&#39;</span><span class="p">,</span> <span class="s1">&#39;WV&#39;</span><span class="p">,</span> <span class="s1">&#39;WD&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Agregar nombre de variable en df_pollutants_def</span>
<span class="n">df_pollutants_def</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensor_variables</span>
<span class="n">df_pollutants_def</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
      <th>var_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>$\text{PM}_{10}$</td>
      <td>2.00</td>
      <td>850.0</td>
      <td>$\mu\text{gr}$ / $\text{m}^3$</td>
      <td>PM10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>$\text{PM}_{2.5}$</td>
      <td>2.00</td>
      <td>850.0</td>
      <td>$\mu\text{gr}$ / $\text{m}^3$</td>
      <td>PM2_5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>$\text{O}_3$</td>
      <td>1.00</td>
      <td>200.0</td>
      <td>ppb</td>
      <td>O3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NO</td>
      <td>1.00</td>
      <td>350.0</td>
      <td>ppb</td>
      <td>NO</td>
    </tr>
    <tr>
      <th>4</th>
      <td>$\text{NO}_2$</td>
      <td>1.00</td>
      <td>150.0</td>
      <td>ppb</td>
      <td>NO2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>$\text{NO}_X$</td>
      <td>1.00</td>
      <td>350.0</td>
      <td>ppb</td>
      <td>NOX</td>
    </tr>
    <tr>
      <th>6</th>
      <td>$\text{SO}_2$</td>
      <td>1.00</td>
      <td>200.0</td>
      <td>ppb</td>
      <td>SO2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CO</td>
      <td>0.05</td>
      <td>15.0</td>
      <td>ppm</td>
      <td>CO</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Temperature</td>
      <td>-15.00</td>
      <td>50.0</td>
      <td>C</td>
      <td>T</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Relative humidity</td>
      <td>0.00</td>
      <td>100.0</td>
      <td>%</td>
      <td>RH</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Barometric pressure</td>
      <td>650.00</td>
      <td>750.0</td>
      <td>mmHg</td>
      <td>BP</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Solar radiation</td>
      <td>0.00</td>
      <td>1.2</td>
      <td>Langley / h</td>
      <td>SR</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Rainfall</td>
      <td>0.00</td>
      <td>inf</td>
      <td>mm / h</td>
      <td>RF</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Wind velocity</td>
      <td>0.00</td>
      <td>60.0</td>
      <td>Km / h</td>
      <td>WV</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Wind direction</td>
      <td>0.00</td>
      <td>360.0</td>
      <td>Azimutales</td>
      <td>WD</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a class="reference external" href="https://numpy.org/"><code class="docutils literal notranslate"><span class="pre">numpy</span></code></a> es una librería de Python para realizar operaciones matemáticas con arreglos y matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copia de dataframe</span>
<span class="n">df_pollutants_copy</span> <span class="o">=</span> <span class="n">df_pollutants</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Contador de valores fuera de rango</span>
<span class="n">errors</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">df_pollutants_def</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Valores por debajo</span>
    <span class="n">errors</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_pollutants_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pollutants_copy</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">s</span><span class="o">.</span><span class="n">min_value</span><span class="p">])</span>
    <span class="n">errors</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_pollutants_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pollutants_copy</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">max_value</span><span class="p">])</span>
    <span class="c1"># Se usa np.nan para dejar vacíos esos lugares con valores fuera de rango</span>
    <span class="n">df_pollutants_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pollutants_copy</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">s</span><span class="o">.</span><span class="n">min_value</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">df_pollutants_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pollutants_copy</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">max_value</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>387746
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_copy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>BP</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WV</th>
      <th>WD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1993-01-01 00:00:00</td>
      <td>Sureste</td>
      <td>0.95</td>
      <td>NaN</td>
      <td>5.75</td>
      <td>6.75</td>
      <td>19.0</td>
      <td>41.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.5</td>
      <td>0.007</td>
      <td>17.25</td>
      <td>17.54</td>
      <td>96.84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1993-01-01 00:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1993-01-01 00:00:00</td>
      <td>Centro</td>
      <td>2.58</td>
      <td>1.25</td>
      <td>11.0</td>
      <td>8.5</td>
      <td>18.5</td>
      <td>30.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>17.25</td>
      <td>11.91</td>
      <td>86.94</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1993-01-01 00:00:00</td>
      <td>Noroeste</td>
      <td>0.98</td>
      <td>4.25</td>
      <td>6.75</td>
      <td>11.0</td>
      <td>24.5</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>9.25</td>
      <td>NaN</td>
      <td>17.45</td>
      <td>45.29</td>
      <td>96.84</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1993-01-01 00:00:00</td>
      <td>Suroeste</td>
      <td>1.65</td>
      <td>3.0</td>
      <td>14.25</td>
      <td>17.5</td>
      <td>6.0</td>
      <td>38.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.65</td>
      <td>15.77</td>
      <td>93.96</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>113887</th>
      <td>2019-12-31 19:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>22</td>
      <td>NaN</td>
      <td>722.3</td>
      <td>NaN</td>
      <td>96</td>
      <td>2</td>
      <td>0</td>
      <td>10.15</td>
      <td>9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113888</th>
      <td>2019-12-31 20:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>NaN</td>
      <td>721.9</td>
      <td>NaN</td>
      <td>96</td>
      <td>2.2</td>
      <td>0</td>
      <td>10.21</td>
      <td>10</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113889</th>
      <td>2019-12-31 21:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>43</td>
      <td>NaN</td>
      <td>722.2</td>
      <td>NaN</td>
      <td>96</td>
      <td>1.8</td>
      <td>0</td>
      <td>10.39</td>
      <td>8.1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113890</th>
      <td>2019-12-31 22:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>70</td>
      <td>NaN</td>
      <td>722.1</td>
      <td>NaN</td>
      <td>96</td>
      <td>1.8</td>
      <td>0</td>
      <td>10.54</td>
      <td>8.2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113891</th>
      <td>2019-12-31 23:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>86</td>
      <td>NaN</td>
      <td>722</td>
      <td>NaN</td>
      <td>96</td>
      <td>1.5</td>
      <td>0</td>
      <td>10.73</td>
      <td>6.7</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1656563 rows × 17 columns</p>
</div></div></div>
</div>
<p>Visualización</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">df_pollutants_copy</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">)[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">]</span>
<span class="n">rangos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
  <span class="n">rangos</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">b</span><span class="p">)]</span>
  <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
  
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab20</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rangos</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">broken_barh</span><span class="p">([(</span><span class="n">rangos</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rangos</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">rangos</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">rangos</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;1993-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;YS&#39;</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1993</span><span class="p">,</span> <span class="mi">2021</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.12</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1_datos_60_0.png" src="../_images/1_datos_60_0.png" />
</div>
</div>
<p>Se selecciona un rango con el que trabajar. En este caso, de 01-01-2017 a 31-12-2019.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_2017</span> <span class="o">=</span> <span class="n">df_pollutants</span><span class="p">[</span><span class="n">df_pollutants</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">2017</span><span class="p">]</span>
<span class="n">df_pollutants_2017</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>BP</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WV</th>
      <th>WD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1314936</th>
      <td>2017-01-01 00:00:00</td>
      <td>Sureste</td>
      <td>3.77</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>206.0</td>
      <td>NaN</td>
      <td>720.5</td>
      <td>0.0</td>
      <td>72.0</td>
      <td>11.8</td>
      <td>0.007</td>
      <td>18.71</td>
      <td>8.8</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>1314937</th>
      <td>2017-01-01 00:00:00</td>
      <td>Noreste</td>
      <td>4.66</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>487.0</td>
      <td>NaN</td>
      <td>716.6</td>
      <td>0.0</td>
      <td>72.0</td>
      <td>19.1</td>
      <td>0.0</td>
      <td>17.94</td>
      <td>4.3</td>
      <td>313.0</td>
    </tr>
    <tr>
      <th>1314938</th>
      <td>2017-01-01 00:00:00</td>
      <td>Centro</td>
      <td>2.47</td>
      <td>16.0</td>
      <td>15.1</td>
      <td>31.1</td>
      <td>6.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>709.2</td>
      <td>0.0</td>
      <td>64.0</td>
      <td>NaN</td>
      <td>0.004</td>
      <td>19.46</td>
      <td>3.0</td>
      <td>300.0</td>
    </tr>
    <tr>
      <th>1314939</th>
      <td>2017-01-01 00:00:00</td>
      <td>Noroeste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>241.0</td>
      <td>NaN</td>
      <td>709.2</td>
      <td>0.0</td>
      <td>56.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>330.0</td>
    </tr>
    <tr>
      <th>1314940</th>
      <td>2017-01-01 00:00:00</td>
      <td>Suroeste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>112.0</td>
      <td>NaN</td>
      <td>698.8</td>
      <td>0.0</td>
      <td>57.0</td>
      <td>NaN</td>
      <td>0.001</td>
      <td>20.35</td>
      <td>6.7</td>
      <td>269.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>113887</th>
      <td>2019-12-31 19:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>22</td>
      <td>NaN</td>
      <td>722.3</td>
      <td>NaN</td>
      <td>96</td>
      <td>2</td>
      <td>0</td>
      <td>10.15</td>
      <td>9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113888</th>
      <td>2019-12-31 20:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31</td>
      <td>NaN</td>
      <td>721.9</td>
      <td>NaN</td>
      <td>96</td>
      <td>2.2</td>
      <td>0</td>
      <td>10.21</td>
      <td>10</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113889</th>
      <td>2019-12-31 21:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>43</td>
      <td>NaN</td>
      <td>722.2</td>
      <td>NaN</td>
      <td>96</td>
      <td>1.8</td>
      <td>0</td>
      <td>10.39</td>
      <td>8.1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113890</th>
      <td>2019-12-31 22:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>70</td>
      <td>NaN</td>
      <td>722.1</td>
      <td>NaN</td>
      <td>96</td>
      <td>1.8</td>
      <td>0</td>
      <td>10.54</td>
      <td>8.2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113891</th>
      <td>2019-12-31 23:00:00</td>
      <td>Noreste</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>86</td>
      <td>NaN</td>
      <td>722</td>
      <td>NaN</td>
      <td>96</td>
      <td>1.5</td>
      <td>0</td>
      <td>10.73</td>
      <td>6.7</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>341627 rows × 17 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">imputations</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab20</span>
    <span class="k">for</span> <span class="n">station</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
      <span class="c1"># https://stackoverflow.com/questions/21402384/how-to-split-a-pandas-time-series-by-nan-values/66015224#66015224</span>
      <span class="c1"># Convert to sparse then query index to find block locations</span>
      <span class="c1"># different way of converting to sparse in pandas&gt;=0.25.0</span>
      <span class="n">sparse_ts</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">SparseDtype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">))</span>
      <span class="c1"># we need to use .values.sp_index.to_block_index() in this version of pandas</span>
      <span class="n">block_locs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
          <span class="n">sparse_ts</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">sp_index</span><span class="o">.</span><span class="n">to_block_index</span><span class="p">()</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
          <span class="n">sparse_ts</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">sp_index</span><span class="o">.</span><span class="n">to_block_index</span><span class="p">()</span><span class="o">.</span><span class="n">blengths</span><span class="p">,</span>
      <span class="p">)</span>
      <span class="c1"># Map the sparse blocks back to the dense timeseries</span>
      <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span>
          <span class="n">ts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span> <span class="ow">in</span> <span class="n">block_locs</span>
      <span class="p">]</span>

      <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
          <span class="k">continue</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">broken_barh</span><span class="p">([(</span><span class="nb">min</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">timestamp</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="n">station</span><span class="p">)</span>
          <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">broken_barh</span><span class="p">([(</span><span class="nb">min</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">timestamp</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
      <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2017-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;YS&#39;</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">2021</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.12</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputations</span><span class="p">([</span><span class="s1">&#39;CO&#39;</span><span class="p">],</span> <span class="n">df_pollutants_2017</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CO
</pre></div>
</div>
<img alt="../_images/1_datos_64_1.png" src="../_images/1_datos_64_1.png" />
</div>
</div>
<p>Ahora se agrega información geográfica de las estaciones de monitoreo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_stations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/estaciones_coords.csv&#39;</span><span class="p">)</span>
<span class="n">df_stations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>station</th>
      <th>abbr</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Centro</td>
      <td>C</td>
      <td>25.6700</td>
      <td>-100.3380</td>
      <td>560</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Noreste</td>
      <td>NE</td>
      <td>25.7500</td>
      <td>-100.2550</td>
      <td>476</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Noreste2</td>
      <td>NE2</td>
      <td>25.7770</td>
      <td>-100.1880</td>
      <td>432</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Noroeste</td>
      <td>NO</td>
      <td>25.7570</td>
      <td>-100.3660</td>
      <td>571</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Noroeste2</td>
      <td>NO2</td>
      <td>25.7830</td>
      <td>-100.5860</td>
      <td>716</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Norte</td>
      <td>N</td>
      <td>25.8000</td>
      <td>-100.3440</td>
      <td>528</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Norte2</td>
      <td>N2</td>
      <td>25.5749</td>
      <td>-100.2489</td>
      <td>630</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sur</td>
      <td>S</td>
      <td>25.7295</td>
      <td>-100.3099</td>
      <td>520</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Sureste</td>
      <td>SE</td>
      <td>25.6680</td>
      <td>-100.2490</td>
      <td>492</td>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sureste2</td>
      <td>SE2</td>
      <td>25.6460</td>
      <td>-100.0960</td>
      <td>387</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Sureste3</td>
      <td>SE3</td>
      <td>25.3600</td>
      <td>-99.9955</td>
      <td>340</td>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Suroeste</td>
      <td>SO</td>
      <td>25.6760</td>
      <td>-100.4640</td>
      <td>694</td>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.6650</td>
      <td>-100.4130</td>
      <td>636</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pollutants_coords</span> <span class="o">=</span> <span class="n">df_stations</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_pollutants_2017</span><span class="p">,</span>
    <span class="c1"># unir DataFrames de datos con coordenadas</span>
    <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;station&#39;</span>
<span class="p">)</span>
<span class="n">df_pollutants_coords</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>station</th>
      <th>abbr</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>timestamp</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>...</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>BP</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WV</th>
      <th>WD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Centro</td>
      <td>C</td>
      <td>25.67</td>
      <td>-100.338</td>
      <td>560</td>
      <td>2017-01-01 00:00:00</td>
      <td>2.47</td>
      <td>16.0</td>
      <td>15.1</td>
      <td>31.1</td>
      <td>...</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>709.2</td>
      <td>0.0</td>
      <td>64.0</td>
      <td>NaN</td>
      <td>0.004</td>
      <td>19.46</td>
      <td>3.0</td>
      <td>300.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Centro</td>
      <td>C</td>
      <td>25.67</td>
      <td>-100.338</td>
      <td>560</td>
      <td>2017-01-01 01:00:00</td>
      <td>2.18</td>
      <td>8.9</td>
      <td>11.7</td>
      <td>20.6</td>
      <td>...</td>
      <td>183.0</td>
      <td>NaN</td>
      <td>708.9</td>
      <td>0.0</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>0.004</td>
      <td>18.92</td>
      <td>2.0</td>
      <td>226.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Centro</td>
      <td>C</td>
      <td>25.67</td>
      <td>-100.338</td>
      <td>560</td>
      <td>2017-01-01 02:00:00</td>
      <td>1.77</td>
      <td>2.0</td>
      <td>8.6</td>
      <td>10.5</td>
      <td>...</td>
      <td>142.0</td>
      <td>NaN</td>
      <td>708.5</td>
      <td>0.0</td>
      <td>56.0</td>
      <td>NaN</td>
      <td>0.004</td>
      <td>20.42</td>
      <td>2.6</td>
      <td>246.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Centro</td>
      <td>C</td>
      <td>25.67</td>
      <td>-100.338</td>
      <td>560</td>
      <td>2017-01-01 03:00:00</td>
      <td>1.93</td>
      <td>7.2</td>
      <td>10.0</td>
      <td>17.2</td>
      <td>...</td>
      <td>101.0</td>
      <td>NaN</td>
      <td>708.2</td>
      <td>0.0</td>
      <td>52.0</td>
      <td>NaN</td>
      <td>0.004</td>
      <td>21.21</td>
      <td>5.4</td>
      <td>152.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Centro</td>
      <td>C</td>
      <td>25.67</td>
      <td>-100.338</td>
      <td>560</td>
      <td>2017-01-01 04:00:00</td>
      <td>1.7</td>
      <td>2.1</td>
      <td>8.6</td>
      <td>10.7</td>
      <td>...</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>707.9</td>
      <td>0.0</td>
      <td>54.0</td>
      <td>NaN</td>
      <td>0.004</td>
      <td>20.47</td>
      <td>3.6</td>
      <td>232.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
<p>Dada la naturaleza de los datos, se sabe que <span class="math notranslate nohighlight">\(\text{NO}_x\)</span> es la suma de <span class="math notranslate nohighlight">\(\text{NO}\)</span> y <span class="math notranslate nohighlight">\(\text{NO}_2\)</span>. Se rellenan valores de alguna de estas variables, con la suma o resta de las dos restantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conteo de vacíos</span>
<span class="n">nox_na</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="p">[[</span><span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nox_na</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NO     221971
NO2    230756
NOX    224879
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOx vacíos</span>
<span class="n">df_nox_na</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="p">[(</span><span class="o">~</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NO</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NO2</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NOX</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span>
<span class="c1"># NOx = NO + NO2</span>
<span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_nox_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_nox_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_nox_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Con NO</span>
<span class="n">df_no_na</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="p">[(</span><span class="o">~</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NOX</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NO2</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NO</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span>
<span class="c1"># NO = NOx - NO2</span>
<span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_no_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_no_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_no_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Y NO2</span>
<span class="n">df_no2_na</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="p">[(</span><span class="o">~</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NOX</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NO</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">NO2</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span>
<span class="c1"># NO2 = NOx - NO</span>
<span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_no2_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_no2_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_pollutants_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_no2_na</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reconstrucción</span>
<span class="n">nox_na_new</span> <span class="o">=</span> <span class="n">df_pollutants_coords</span><span class="p">[[</span><span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nox_na</span> <span class="o">-</span> <span class="n">nox_na_new</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NO      782
NO2    4936
NOX      38
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Ahora, se convierten todas las columnas de variables y sus valores, en una columna llamada variable y otra llamada valor, que se asignan a cada una de ellas, con los demás atributos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://pandas.pydata.org/docs/reference/api/pandas.melt.html</span>
<span class="n">df_pollutants_melt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">df_pollutants_coords</span><span class="p">,</span> 
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">],</span> <span class="c1"># Variables que se mantienen</span>
    <span class="n">value_vars</span> <span class="o">=</span> <span class="n">df_pollutants_def</span><span class="o">.</span><span class="n">var_name</span> <span class="c1"># Variables que se compactan</span>
<span class="p">)</span>
<span class="n">df_pollutants_melt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>abbr</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-01-01 00:00:00</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-01-01 01:00:00</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-01-01 02:00:00</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-01-01 03:00:00</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-01-01 04:00:00</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>2019-12-31 19:00:00</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>82</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>2019-12-31 20:00:00</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>87</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>2019-12-31 21:00:00</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>98</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>2019-12-31 22:00:00</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>104</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>2019-12-31 23:00:00</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>137</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 8 columns</p>
</div></div></div>
</div>
<p>Para interpolar, no hace falta el nombre de la estación ni su abreviatura.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sel</span> <span class="o">=</span> <span class="n">df_pollutants_melt</span><span class="p">[[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
<span class="n">df_sel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-01-01 00:00:00</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-01-01 01:00:00</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-01-01 02:00:00</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-01-01 03:00:00</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-01-01 04:00:00</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>2019-12-31 19:00:00</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>82</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>2019-12-31 20:00:00</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>87</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>2019-12-31 21:00:00</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>98</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>2019-12-31 22:00:00</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>104</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>2019-12-31 23:00:00</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>137</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 6 columns</p>
</div></div></div>
</div>
<p>Más preprocesamiento, pero ahora enfocado a los métodos que nos interesan. Como los métodos de AA no trabajan con fechas, se convierten las fechas a enteros basados en la medida de <a class="reference external" href="https://docs.python.org/3/library/time.html">inicio de época de Unix</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/a/54312941</span>
<span class="c1"># https://stackoverflow.com/a/51245631</span>
<span class="n">df_sel</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">df_sel</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span>
<span class="n">df_sel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\user\AppData\Local\Temp\ipykernel_20832\1444388773.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_sel.timestamp = df_sel.timestamp.values.astype(np.int64) / 10 ** 9
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.483229e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.483232e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.483236e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.483240e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.483243e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>1.577819e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>82</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>1.577822e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>87</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>1.577826e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>98</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>1.577830e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>104</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>1.577833e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>137</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 6 columns</p>
</div></div></div>
</div>
<p>Ahora, para tomar en cuenta las variables como parámetros de los modelos, se utiliza el método de one-hot endoding.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://towardsdatascience.com/ways-to-handle-categorical-data-before-train-ml-models-with-implementation-ffc213dc84ec</span>
<span class="n">df_sel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sel</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_sel</span><span class="o">.</span><span class="n">variable</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_sel</span> <span class="o">=</span> <span class="n">df_sel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">])</span>
<span class="n">df_sel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>value</th>
      <th>BP</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WD</th>
      <th>WV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.483229e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>143.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.483232e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>183.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.483236e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>142.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.483240e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>101.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.483243e+09</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>85.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>1.577819e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>82</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>1.577822e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>87</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>1.577826e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>98</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>1.577830e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>104</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>1.577833e+09</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>137</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 20 columns</p>
</div></div></div>
</div>
<p>Muchos de los algoritmos de AA tienen como supuestos que los datos estén normalizados. Existen muchas maneras de hacerlo. Aquí se usa <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html"><code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code></a>, que devuelve cada columna a un rango <span class="math notranslate nohighlight">\([0, 1] \in \mathbb{R}\)</span>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="c1"># https://stackoverflow.com/a/43383700</span>
<span class="n">scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_sel</span><span class="p">)</span>
<span class="c1"># https://datatofish.com/numpy-array-to-pandas-dataframe/</span>
<span class="n">df_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaled</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">df_sel</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_scaled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>value</th>
      <th>BP</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WD</th>
      <th>WV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.075931</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000038</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.094495</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000076</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.075466</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000114</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.056437</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000152</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.049011</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>0.999848</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.047619</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>0.999886</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.049940</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>0.999924</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.055045</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>0.999962</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.057830</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>1.000000</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.073146</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 20 columns</p>
</div></div></div>
</div>
<p>Selección de valores no vacíos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_dropna</span> <span class="o">=</span> <span class="n">df_scaled</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df_dropna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>value</th>
      <th>BP</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WD</th>
      <th>WV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.075931</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000038</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.094495</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000076</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.075466</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000114</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.056437</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000152</td>
      <td>0.704545</td>
      <td>0.419983</td>
      <td>0.585106</td>
      <td>0.049011</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>0.999848</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.047619</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>0.999886</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.049940</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>0.999924</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.055045</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>0.999962</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.057830</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>1.000000</td>
      <td>0.693182</td>
      <td>0.292972</td>
      <td>0.787234</td>
      <td>0.073146</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>3441764 rows × 20 columns</p>
</div></div></div>
</div>
<p>Separación en conjuntos de entrenamiento y prueba.</p>
<p>Entrenamiento</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/a/35531218</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">df_dropna</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="n">df_pollutants_def</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Prueba</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test</span> <span class="o">=</span> <span class="n">df_dropna</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">x_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="p">[</span><span class="n">df_pollutants_def</span><span class="o">.</span><span class="n">var_name</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./caps"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="0_preliminares.html" title="anterior página">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">anterior</p>
            <p class="prev-next-title">Preliminares</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2_estadisticos.html" title="siguiente página">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title">Estadística descriptiva básica</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Alberto Benavides<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>