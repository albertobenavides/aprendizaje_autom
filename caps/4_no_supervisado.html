
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Aprendizaje no supervisado &#8212; Aprendizaje automático</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Aprendizaje supervisado" href="5_supervisado.html" />
    <link rel="prev" title="Selección de características" href="3_sel_carac.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="es">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Aprendizaje automático</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Aprendizaje automático
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="0_preliminares.html">
   Preliminares
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_datos.html">
   Datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_estadisticos.html">
   Estadística descriptiva básica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_sel_carac.html">
   Selección de características
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Aprendizaje no supervisado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_supervisado.html">
   Aprendizaje supervisado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_clasificacion.html">
   Clasificación
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_metricas_desempeno.html">
   Métricas de desempeño
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_diseno_experimentos.html">
   Diseño de experimentos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_resultados.html">
   Resultados
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_articulo.html">
   Artículo científico
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/albertobenavides/aprendizaje_autom/master?urlpath=tree/docs/caps/4_no_supervisado.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/albertobenavides/aprendizaje_autom"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/albertobenavides/aprendizaje_autom/issues/new?title=Issue%20on%20page%20%2Fcaps/4_no_supervisado.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/caps/4_no_supervisado.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analisis-de-correspondencia">
   Análisis de correspondencia
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#k-medias">
   <span class="math notranslate nohighlight">
    \(K\)
   </span>
   -medias
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#paralelizacion">
     Paralelización
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seleccionar-numero-de-grupos">
     Seleccionar número de grupos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#agrupamiento-jerarquico">
   Agrupamiento jerárquico
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tarea-en-clase-2-puntos">
   Tarea en clase (2 puntos)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tarea-8-puntos">
   Tarea (8 puntos)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recursos">
   Recursos
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Aprendizaje no supervisado</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analisis-de-correspondencia">
   Análisis de correspondencia
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#k-medias">
   <span class="math notranslate nohighlight">
    \(K\)
   </span>
   -medias
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#paralelizacion">
     Paralelización
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seleccionar-numero-de-grupos">
     Seleccionar número de grupos
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#agrupamiento-jerarquico">
   Agrupamiento jerárquico
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tarea-en-clase-2-puntos">
   Tarea en clase (2 puntos)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tarea-8-puntos">
   Tarea (8 puntos)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recursos">
   Recursos
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="aprendizaje-no-supervisado">
<h1>Aprendizaje no supervisado<a class="headerlink" href="#aprendizaje-no-supervisado" title="Enlazar permanentemente con este título">#</a></h1>
<p>Los métodos no supervisados son aquellos que, sin conocer etiquetas o parámetros objetivo en los datos, se encargan de agrupar, crear subconjuntos o subordinaciones de subconjuntos de datos a partir de distancias entre los datos o subconjuntos de los mismos.</p>
<section id="analisis-de-correspondencia">
<h2>Análisis de correspondencia<a class="headerlink" href="#analisis-de-correspondencia" title="Enlazar permanentemente con este título">#</a></h2>
<p>Uno de los métodos de aprendizaje no supervisado se vio al final de la sesión anterior, PCA. Ahora toca a su contraparte categórica, el <strong>análisis de correspondencia</strong>. Aquí, se estandarizan parámetros continuos y se reducen las dimensiones de los parámetros estandarizados mediante PCA para representar las variables categóricas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/results/df_pollutants_melt.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>abbr</th>
      <th>lat</th>
      <th>lon</th>
      <th>h</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.483229e+09</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.483232e+09</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.483236e+09</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.483240e+09</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.483243e+09</td>
      <td>Centro</td>
      <td>C</td>
      <td>25.670</td>
      <td>-100.338</td>
      <td>560</td>
      <td>PM10</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>1.577819e+09</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>1.577822e+09</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>1.577826e+09</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>1.577830e+09</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>104.0</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>1.577833e+09</td>
      <td>Suroeste2</td>
      <td>SO2</td>
      <td>25.665</td>
      <td>-100.413</td>
      <td>636</td>
      <td>WD</td>
      <td>137.0</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sel</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
<span class="n">df_sel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>station</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.483229e+09</td>
      <td>Centro</td>
      <td>PM10</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.483232e+09</td>
      <td>Centro</td>
      <td>PM10</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.483236e+09</td>
      <td>Centro</td>
      <td>PM10</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.483240e+09</td>
      <td>Centro</td>
      <td>PM10</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.483243e+09</td>
      <td>Centro</td>
      <td>PM10</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>1.577819e+09</td>
      <td>Suroeste2</td>
      <td>WD</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>1.577822e+09</td>
      <td>Suroeste2</td>
      <td>WD</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>1.577826e+09</td>
      <td>Suroeste2</td>
      <td>WD</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>1.577830e+09</td>
      <td>Suroeste2</td>
      <td>WD</td>
      <td>104.0</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>1.577833e+09</td>
      <td>Suroeste2</td>
      <td>WD</td>
      <td>137.0</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_sel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\begin{tabular}{rllr}
\toprule
   timestamp &amp; station &amp; variable &amp;  value \\
\midrule
1483228800.0 &amp;  Centro &amp;     PM10 &amp;  143.0 \\
1483232400.0 &amp;  Centro &amp;     PM10 &amp;  183.0 \\
1483236000.0 &amp;  Centro &amp;     PM10 &amp;  142.0 \\
1483239600.0 &amp;  Centro &amp;     PM10 &amp;  101.0 \\
1483243200.0 &amp;  Centro &amp;     PM10 &amp;   85.0 \\
1483246800.0 &amp;  Centro &amp;     PM10 &amp;   52.0 \\
1483250400.0 &amp;  Centro &amp;     PM10 &amp;   55.0 \\
1483254000.0 &amp;  Centro &amp;     PM10 &amp;   48.0 \\
1483257600.0 &amp;  Centro &amp;     PM10 &amp;   31.0 \\
1483261200.0 &amp;  Centro &amp;     PM10 &amp;   35.0 \\
\bottomrule
\end{tabular}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\user\AppData\Local\Temp\ipykernel_3844\1032066995.py:1: FutureWarning: In future versions `DataFrame.to_latex` is expected to utilise the base implementation of `Styler.to_latex` for formatting and rendering. The arguments signature may therefore change. It is recommended instead to use `DataFrame.style.to_latex` which also contains additional functionality.
  print(df_sel.iloc[:10].to_latex(index=False))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sel_x</span> <span class="o">=</span> <span class="n">df_sel</span><span class="p">[[</span>
    <span class="c1">#&#39;timestamp&#39;, </span>
    <span class="s1">&#39;value&#39;</span><span class="p">]]</span>
<span class="n">df_sel_x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>183.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>142.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>101.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>85.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>82.0</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>87.0</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>98.0</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>104.0</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>137.0</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="c1"># https://stackoverflow.com/a/43383700</span>
<span class="n">scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_sel_x</span><span class="p">)</span>
<span class="c1"># https://datatofish.com/numpy-array-to-pandas-dataframe/</span>
<span class="n">df_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaled</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">df_sel_x</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_scaled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.193371</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.240651</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.192189</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.143728</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.124817</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>0.121271</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>0.127181</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>0.140182</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>0.147274</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>0.186280</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_sel</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span>
<span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;station&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_sel</span><span class="p">[</span><span class="s1">&#39;station&#39;</span><span class="p">]</span>
<span class="n">df_scaled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>variable</th>
      <th>station</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.193371</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.240651</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.192189</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.143728</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.124817</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>0.121271</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>0.127181</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>0.140182</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>0.147274</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>0.186280</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
  </tbody>
</table>
<p>5124405 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_dropna</span> <span class="o">=</span> <span class="n">df_scaled</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df_dropna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>variable</th>
      <th>station</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.193371</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.240651</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.192189</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.143728</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.124817</td>
      <td>PM10</td>
      <td>Centro</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5124400</th>
      <td>0.121271</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124401</th>
      <td>0.127181</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124402</th>
      <td>0.140182</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124403</th>
      <td>0.147274</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
    <tr>
      <th>5124404</th>
      <td>0.186280</td>
      <td>WD</td>
      <td>Suroeste2</td>
    </tr>
  </tbody>
</table>
<p>3429819 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span> <span class="o">=</span> <span class="n">df_dropna</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;variable&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">gp_unstacked</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">gp_unstacked</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">gp_unstacked</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">()</span>
<span class="c1"># https://github.com/executablebooks/jupyter-book/issues/1891#issuecomment-1413830585</span>
<span class="n">gp_unstacked</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>variable</th>
      <th>BP</th>
      <th>CO</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>O3</th>
      <th>PM10</th>
      <th>PM2_5</th>
      <th>RF</th>
      <th>RH</th>
      <th>SO2</th>
      <th>SR</th>
      <th>T</th>
      <th>WD</th>
      <th>WV</th>
    </tr>
    <tr>
      <th>station</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Centro</th>
      <td>0.865317</td>
      <td>0.026195</td>
      <td>0.042518</td>
      <td>0.037028</td>
      <td>0.055202</td>
      <td>0.055604</td>
      <td>0.083874</td>
      <td>0.050935</td>
      <td>0.024349</td>
      <td>0.094533</td>
      <td>0.029375</td>
      <td>0.024573</td>
      <td>0.050829</td>
      <td>0.161268</td>
      <td>0.031738</td>
    </tr>
    <tr>
      <th>Noreste</th>
      <td>0.874475</td>
      <td>0.026952</td>
      <td>0.041014</td>
      <td>0.027224</td>
      <td>0.043566</td>
      <td>0.051195</td>
      <td>0.097021</td>
      <td>0.048207</td>
      <td>0.024352</td>
      <td>0.104132</td>
      <td>0.035359</td>
      <td>0.024547</td>
      <td>0.051388</td>
      <td>0.189420</td>
      <td>0.032877</td>
    </tr>
    <tr>
      <th>Noroeste</th>
      <td>0.864475</td>
      <td>0.025436</td>
      <td>0.049730</td>
      <td>0.032242</td>
      <td>0.057654</td>
      <td>0.056404</td>
      <td>0.111122</td>
      <td>0.054893</td>
      <td>0.024351</td>
      <td>0.097422</td>
      <td>0.031874</td>
      <td>0.024544</td>
      <td>0.051715</td>
      <td>0.208695</td>
      <td>0.033919</td>
    </tr>
    <tr>
      <th>Norte</th>
      <td>0.868382</td>
      <td>0.025915</td>
      <td>0.070164</td>
      <td>0.036822</td>
      <td>0.081408</td>
      <td>0.064286</td>
      <td>0.083156</td>
      <td>0.047942</td>
      <td>0.024349</td>
      <td>0.092887</td>
      <td>0.031879</td>
      <td>0.024543</td>
      <td>0.052137</td>
      <td>0.171009</td>
      <td>0.031980</td>
    </tr>
    <tr>
      <th>Norte2</th>
      <td>0.867724</td>
      <td>0.025385</td>
      <td>0.057667</td>
      <td>0.053814</td>
      <td>0.089430</td>
      <td>0.049721</td>
      <td>0.099905</td>
      <td>0.053778</td>
      <td>0.024353</td>
      <td>0.097671</td>
      <td>0.036446</td>
      <td>0.024501</td>
      <td>0.050944</td>
      <td>0.166215</td>
      <td>0.033153</td>
    </tr>
    <tr>
      <th>Sur</th>
      <td>0.859910</td>
      <td>0.025179</td>
      <td>0.040255</td>
      <td>0.041337</td>
      <td>0.056899</td>
      <td>0.060906</td>
      <td>0.072978</td>
      <td>0.040659</td>
      <td>0.024349</td>
      <td>0.102234</td>
      <td>0.032853</td>
      <td>0.024533</td>
      <td>0.049458</td>
      <td>0.227795</td>
      <td>0.027221</td>
    </tr>
    <tr>
      <th>Sureste2</th>
      <td>0.878245</td>
      <td>0.026921</td>
      <td>0.068904</td>
      <td>0.036766</td>
      <td>0.079788</td>
      <td>0.052002</td>
      <td>0.096409</td>
      <td>0.047704</td>
      <td>0.024353</td>
      <td>0.097126</td>
      <td>0.039799</td>
      <td>0.024500</td>
      <td>0.052094</td>
      <td>0.209637</td>
      <td>0.033378</td>
    </tr>
    <tr>
      <th>Sureste3</th>
      <td>0.888832</td>
      <td>0.025253</td>
      <td>0.033623</td>
      <td>0.033125</td>
      <td>0.042302</td>
      <td>0.052798</td>
      <td>0.088695</td>
      <td>0.049209</td>
      <td>0.024354</td>
      <td>0.100316</td>
      <td>0.032179</td>
      <td>0.024562</td>
      <td>0.051353</td>
      <td>0.222459</td>
      <td>0.027713</td>
    </tr>
    <tr>
      <th>Suroeste</th>
      <td>0.853020</td>
      <td>0.025947</td>
      <td>0.062802</td>
      <td>0.051812</td>
      <td>0.089850</td>
      <td>0.051186</td>
      <td>0.104668</td>
      <td>0.050879</td>
      <td>0.024351</td>
      <td>0.096746</td>
      <td>0.032180</td>
      <td>0.024553</td>
      <td>0.050173</td>
      <td>0.218491</td>
      <td>0.034373</td>
    </tr>
    <tr>
      <th>Suroeste2</th>
      <td>0.867320</td>
      <td>0.025683</td>
      <td>0.036263</td>
      <td>0.035503</td>
      <td>0.047091</td>
      <td>0.051734</td>
      <td>0.094248</td>
      <td>0.046332</td>
      <td>0.024358</td>
      <td>0.092260</td>
      <td>0.029361</td>
      <td>0.024559</td>
      <td>0.050738</td>
      <td>0.157508</td>
      <td>0.029360</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">prince</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca</span> <span class="o">=</span> <span class="n">prince</span><span class="o">.</span><span class="n">CA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ca</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gp_unstacked</span><span class="p">)</span>
<span class="n">ca</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gp_unstacked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-ae491ee354434581a6c39a707f9a2940"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ae491ee354434581a6c39a707f9a2940") {
      outputDiv = document.getElementById("altair-viz-ae491ee354434581a6c39a707f9a2940");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-fd7b7e59325d8d7f2f53123cd7979199"}, "mark": {"type": "circle", "size": 50}, "encoding": {"color": {"field": "variable", "type": "nominal"}, "tooltip": [{"field": "variable", "type": "nominal"}, {"field": "value", "type": "nominal"}, {"field": "component 0", "type": "quantitative"}, {"field": "component 1", "type": "quantitative"}], "x": {"axis": {"title": "component 0 \u2014 56.36%"}, "field": "component 0", "scale": {"zero": false}, "type": "quantitative"}, "y": {"axis": {"title": "component 1 \u2014 21.01%"}, "field": "component 1", "scale": {"zero": false}, "type": "quantitative"}}, "selection": {"selector001": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-fd7b7e59325d8d7f2f53123cd7979199": [{"component 0": 0.024934907876295983, "component 1": -0.054033638748495115, "variable": "station", "value": "Centro"}, {"component 0": 0.07597651786418222, "component 1": -0.018701216797537164, "variable": "station", "value": "Noreste"}, {"component 0": 0.024645774217070718, "component 1": 0.010446728794767698, "variable": "station", "value": "Noroeste"}, {"component 0": -0.0778345213831732, "component 1": -0.023775340630127328, "variable": "station", "value": "Norte"}, {"component 0": -0.09487228993420896, "component 1": -0.034740039188921365, "variable": "station", "value": "Norte2"}, {"component 0": 0.047454672783980884, "component 1": 0.0681256163967622, "variable": "station", "value": "Sur"}, {"component 0": -0.057209276481062755, "component 1": 0.028788233161754002, "variable": "station", "value": "Sureste2"}, {"component 0": 0.10050354761957717, "component 1": 0.03360621428297573, "variable": "station", "value": "Sureste3"}, {"component 0": -0.08555930897138157, "component 1": 0.04762719843099992, "variable": "station", "value": "Suroeste"}, {"component 0": 0.055134509211487326, "component 1": -0.06509088137139046, "variable": "station", "value": "Suroeste2"}, {"component 0": 0.0234013023105773, "component 1": -0.018873600489065667, "variable": "variable", "value": "BP"}, {"component 0": 0.01617134136209819, "component 1": -0.022618705122020945, "variable": "variable", "value": "CO"}, {"component 0": -0.21605645587954878, "component 1": 0.012654343617234096, "variable": "variable", "value": "NO"}, {"component 0": -0.12950104641938143, "component 1": 0.013829061369384265, "variable": "variable", "value": "NO2"}, {"component 0": -0.2552665298416774, "component 1": 0.020923045597759638, "variable": "variable", "value": "NOX"}, {"component 0": 0.016858387271780545, "component 1": -0.005925066627471547, "variable": "variable", "value": "O3"}, {"component 0": -0.009971235822279101, "component 1": -0.026659926394789035, "variable": "variable", "value": "PM10"}, {"component 0": -0.005885224569060932, "component 1": -0.042441922675311924, "variable": "variable", "value": "PM2_5"}, {"component 0": 0.018972848677918208, "component 1": -0.018284281973997805, "variable": "variable", "value": "RF"}, {"component 0": 0.034794793510239785, "component 1": 0.0023025459192454597, "variable": "variable", "value": "RH"}, {"component 0": -0.015315821743274005, "component 1": 0.010464757667747326, "variable": "variable", "value": "SO2"}, {"component 0": 0.01946838268779144, "component 1": -0.018437023541243398, "variable": "variable", "value": "SR"}, {"component 0": 0.016539979114055414, "component 1": -0.0228117566152664, "variable": "variable", "value": "T"}, {"component 0": 0.04197746521075357, "component 1": 0.11293989974668528, "variable": "variable", "value": "WD"}, {"component 0": -0.030242624967370235, "component 1": -0.030939712711721985, "variable": "variable", "value": "WV"}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [ ] Comparación entre frecuencias de palabras para autores</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="k-medias">
<h2><span class="math notranslate nohighlight">\(K\)</span>-medias<a class="headerlink" href="#k-medias" title="Enlazar permanentemente con este título">#</a></h2>
<p>Esta técnica no supervisada consiste en generar <span class="math notranslate nohighlight">\(K \in \mathbb{N}\)</span> grupos para <span class="math notranslate nohighlight">\(n\)</span> elementos que incluyan a los <span class="math notranslate nohighlight">\(n_k\)</span> más cercanos (con base en cierta medida de distancia, generalmente euclidiana) respecto a un centroide <span class="math notranslate nohighlight">\(c_k = (\hat{x}, \hat{y})\)</span> tal que
$<span class="math notranslate nohighlight">\(\hat{x} = \frac{1}{n_k} \sum_{i \in K} x_i,\)</span><span class="math notranslate nohighlight">\( 
\)</span><span class="math notranslate nohighlight">\(\hat{y} = \frac{1}{n_k} \sum_{i \in K} y_i.\)</span>$</p>
<p>Formalmente, la distancia más cercana respecto a los centroides <span class="math notranslate nohighlight">\(c_k\)</span> se define como la minimización del error cuadrado para cada grupo
$<span class="math notranslate nohighlight">\(\text{SS}_k = \sum_{i \in K} (x_i - \hat{x}_k)^2 + (y_i - \hat{y}_k)^2.\)</span>$</p>
<p>Este algoritmo es iterativo y tiene como función objetivo</p>
<div class="math notranslate nohighlight">
\[\min \sum_{i \in K} \text{SS}_k.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_dropna</span> <span class="o">=</span> <span class="n">df_sel</span><span class="p">[[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_dropna</span><span class="p">)</span>
<span class="c1"># https://datatofish.com/numpy-array-to-pandas-dataframe/</span>
<span class="n">df_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaled</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">df_dropna</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_scaled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.193371</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000038</td>
      <td>0.240651</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000076</td>
      <td>0.192189</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000114</td>
      <td>0.143728</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000152</td>
      <td>0.124817</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3429814</th>
      <td>0.999848</td>
      <td>0.121271</td>
    </tr>
    <tr>
      <th>3429815</th>
      <td>0.999886</td>
      <td>0.127181</td>
    </tr>
    <tr>
      <th>3429816</th>
      <td>0.999924</td>
      <td>0.140182</td>
    </tr>
    <tr>
      <th>3429817</th>
      <td>0.999962</td>
      <td>0.147274</td>
    </tr>
    <tr>
      <th>3429818</th>
      <td>1.000000</td>
      <td>0.186280</td>
    </tr>
  </tbody>
</table>
<p>3429819 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Se generan 15 grupos, por tener 15 variables</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Esto nos da las etiquetas de los datos</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 7,  7,  7, ..., 13, 13, 13])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># En kmeans, el tamaño de los grupos es variable y depende SÓLO de la distancia entre sus características</span>
<span class="n">df_centroids_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">return_counts</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">df_centroids_freq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ck&#39;</span><span class="p">,</span> <span class="s1">&#39;nk&#39;</span><span class="p">]</span>
<span class="n">df_centroids_freq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ck</th>
      <th>nk</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>362757</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>303858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>82522</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>347813</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>360870</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>78369</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>34550</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>296965</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>66028</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>37110</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>339318</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>367276</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>78907</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>325697</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>347779</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aquí están los centroides 😯</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.6021932 , 0.05184393],
       [0.16538001, 0.05319468],
       [0.62756109, 0.86923688],
       [0.83431172, 0.05523888],
       [0.3789084 , 0.052355  ],
       [0.87257303, 0.86741391],
       [0.72274049, 0.31601426],
       [0.05630124, 0.05365116],
       [0.1297303 , 0.86717327],
       [0.27212353, 0.32547733],
       [0.48654393, 0.05754198],
       [0.71597733, 0.05246211],
       [0.37863545, 0.8685649 ],
       [0.94534211, 0.05345338],
       [0.27351963, 0.05108256]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_centers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">df_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.602193</td>
      <td>0.051844</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.165380</td>
      <td>0.053195</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.627561</td>
      <td>0.869237</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.834312</td>
      <td>0.055239</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.378908</td>
      <td>0.052355</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.872573</td>
      <td>0.867414</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.722740</td>
      <td>0.316014</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.056301</td>
      <td>0.053651</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.129730</td>
      <td>0.867173</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.272124</td>
      <td>0.325477</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.486544</td>
      <td>0.057542</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.715977</td>
      <td>0.052462</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.378635</td>
      <td>0.868565</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.945342</td>
      <td>0.053453</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.273520</td>
      <td>0.051083</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">df_scaled</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> 
    <span class="n">df_scaled</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> 
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="c1"># tamaño de los marcadores</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_centers</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df_centers</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">df_scaled</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">df_scaled</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">s</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="c1"># tamaño de los marcadores</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">c</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_centers</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df_centers</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\pyplot.py:445,</span> in <span class="ni">show</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span><span class="sd"> Display all open figures.</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span><span class="sd"> explicitly there.</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span> <span class="n">_warn_if_gui_out_of_main_thread</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">445</span> <span class="k">return</span> <span class="n">_get_backend_mod</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib_inline\backend_inline.py:90,</span> in <span class="ni">show</span><span class="nt">(close, block)</span>
<span class="g g-Whitespace">     </span><span class="mi">88</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span>     <span class="k">for</span> <span class="n">figure_manager</span> <span class="ow">in</span> <span class="n">Gcf</span><span class="o">.</span><span class="n">get_all_fig_managers</span><span class="p">():</span>
<span class="ne">---&gt; </span><span class="mi">90</span>         <span class="n">display</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span>             <span class="n">figure_manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span>             <span class="n">metadata</span><span class="o">=</span><span class="n">_fetch_figure_metadata</span><span class="p">(</span><span class="n">figure_manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span>         <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span>     <span class="n">show</span><span class="o">.</span><span class="n">_to_draw</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\IPython\core\display_functions.py:298,</span> in <span class="ni">display</span><span class="nt">(include, exclude, metadata, transient, display_id, raw, clear, *objs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>     <span class="n">publish_display_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">298</span>     <span class="n">format_dict</span><span class="p">,</span> <span class="n">md_dict</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">format_dict</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span>         <span class="c1"># nothing to display (e.g. _ipython_display_ took over)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">continue</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\IPython\core\formatters.py:177,</span> in <span class="ni">DisplayFormatter.format</span><span class="nt">(self, obj, include, exclude)</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span> <span class="n">md</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">177</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span> <span class="k">except</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>     <span class="c1"># FIXME: log the exception</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>     <span class="k">raise</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\decorator.py:232,</span> in <span class="ni">decorate.&lt;locals&gt;.fun</span><span class="nt">(*args, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">kwsyntax</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>     <span class="n">args</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">fix</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">232</span> <span class="k">return</span> <span class="n">caller</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">extras</span> <span class="o">+</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\IPython\core\formatters.py:221,</span> in <span class="ni">catch_format_error</span><span class="nt">(method, self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;show traceback on failed format call&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">221</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span> <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>     <span class="c1"># don&#39;t warn on NotImplementedErrors</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_return</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\IPython\core\formatters.py:338,</span> in <span class="ni">BaseFormatter.__call__</span><span class="nt">(self, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span>     <span class="k">pass</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">338</span>     <span class="k">return</span> <span class="n">printer</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span> <span class="c1"># Finally look for special method names</span>
<span class="g g-Whitespace">    </span><span class="mi">340</span> <span class="n">method</span> <span class="o">=</span> <span class="n">get_real_method</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_method</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\IPython\core\pylabtools.py:152,</span> in <span class="ni">print_figure</span><span class="nt">(fig, fmt, bbox_inches, base64, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="kn">from</span> <span class="nn">matplotlib.backend_bases</span> <span class="kn">import</span> <span class="n">FigureCanvasBase</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>     <span class="n">FigureCanvasBase</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">152</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">bytes_io</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bytes_io</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;svg&#39;</span><span class="p">:</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\backend_bases.py:2362,</span> in <span class="ni">FigureCanvasBase.print_figure</span><span class="nt">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2358</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2359</span>     <span class="c1"># _get_renderer may change the figure dpi (as vector formats</span>
<span class="g g-Whitespace">   </span><span class="mi">2360</span>     <span class="c1"># force the figure dpi to 72), so we need to set it again here.</span>
<span class="g g-Whitespace">   </span><span class="mi">2361</span>     <span class="k">with</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_setattr_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2362</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">print_method</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2363</span>             <span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2364</span>             <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2365</span>             <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2366</span>             <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2367</span>             <span class="n">bbox_inches_restore</span><span class="o">=</span><span class="n">_bbox_inches_restore</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2368</span>             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2369</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2370</span>     <span class="k">if</span> <span class="n">bbox_inches</span> <span class="ow">and</span> <span class="n">restore_bbox</span><span class="p">:</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\backend_bases.py:2228,</span> in <span class="ni">FigureCanvasBase._switch_canvas_and_return_print_method.&lt;locals&gt;.&lt;lambda&gt;</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2224</span>     <span class="n">optional_kws</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># Passed by print_figure for other renderers.</span>
<span class="g g-Whitespace">   </span><span class="mi">2225</span>         <span class="s2">&quot;dpi&quot;</span><span class="p">,</span> <span class="s2">&quot;facecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2226</span>         <span class="s2">&quot;bbox_inches_restore&quot;</span><span class="p">}</span>
<span class="g g-Whitespace">   </span><span class="mi">2227</span>     <span class="n">skip</span> <span class="o">=</span> <span class="n">optional_kws</span> <span class="o">-</span> <span class="p">{</span><span class="o">*</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">meth</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">}</span>
<span class="ne">-&gt; </span><span class="mi">2228</span>     <span class="n">print_method</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">meth</span><span class="p">)(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">meth</span><span class="p">(</span>
<span class="nn">   2229         *args, **{k: v for k, v</span> in <span class="ni">kwargs.items</span><span class="nt">() if k not in skip}))</span>
<span class="g g-Whitespace">   </span><span class="mi">2230</span> <span class="k">else</span><span class="p">:</span>  <span class="c1"># Let third-parties do as they see fit.</span>
<span class="g g-Whitespace">   </span><span class="mi">2231</span>     <span class="n">print_method</span> <span class="o">=</span> <span class="n">meth</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\backends\backend_agg.py:509,</span> in <span class="ni">FigureCanvasAgg.print_png</span><span class="nt">(self, filename_or_obj, metadata, pil_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span> <span class="k">def</span> <span class="nf">print_png</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename_or_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span><span class="sd">     Write the figure to a PNG file.</span>
<span class="g g-Whitespace">    </span><span class="mi">465</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span><span class="sd">         *metadata*, including the default &#39;Software&#39; key.</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">509</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_print_pil</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\backends\backend_agg.py:457,</span> in <span class="ni">FigureCanvasAgg._print_pil</span><span class="nt">(self, filename_or_obj, fmt, pil_kwargs, metadata)</span>
<span class="g g-Whitespace">    </span><span class="mi">452</span> <span class="k">def</span> <span class="nf">_print_pil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename_or_obj</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">454</span><span class="sd">     Draw the canvas, then save it using `.image.imsave` (to which</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span><span class="sd">     *pil_kwargs* and *metadata* are forwarded).</span>
<span class="g g-Whitespace">    </span><span class="mi">456</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">457</span>     <span class="n">FigureCanvasAgg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span>     <span class="n">mpl</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imsave</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>         <span class="n">filename_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_rgba</span><span class="p">(),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>         <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="o">=</span><span class="n">pil_kwargs</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\backends\backend_agg.py:400,</span> in <span class="ni">FigureCanvasAgg.draw</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="c1"># Acquire a lock on the shared font cache.</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span> <span class="k">with</span> <span class="n">RendererAgg</span><span class="o">.</span><span class="n">lock</span><span class="p">,</span> \
<span class="g g-Whitespace">    </span><span class="mi">398</span>      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">_wait_cursor_for_draw_cm</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span>       <span class="k">else</span> <span class="n">nullcontext</span><span class="p">()):</span>
<span class="ne">--&gt; </span><span class="mi">400</span>     <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>     <span class="c1"># A GUI class may be need to update a window using this draw, so</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="c1"># don&#39;t forget to call the superclass.</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\artist.py:95,</span> in <span class="ni">_finalize_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer, *args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">draw</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span> <span class="k">def</span> <span class="nf">draw_wrapper</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">95</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span>     <span class="k">if</span> <span class="n">renderer</span><span class="o">.</span><span class="n">_rasterizing</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">stop_rasterizing</span><span class="p">()</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\figure.py:3125,</span> in <span class="ni">Figure.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3122</span>         <span class="c1"># ValueError can occur when resizing a window.</span>
<span class="g g-Whitespace">   </span><span class="mi">3124</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3125</span> <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3126</span>     <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3128</span> <span class="k">for</span> <span class="n">sfig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3129</span>     <span class="n">sfig</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\image.py:131,</span> in <span class="ni">_draw_list_compositing_images</span><span class="nt">(renderer, parent, artists, suppress_composite)</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span> <span class="k">if</span> <span class="n">not_composite</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">has_images</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span>     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">131</span>         <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="c1"># Composite any adjacent images together</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="n">image_group</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\axes\_base.py:3066,</span> in <span class="ni">_AxesBase.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3063</span> <span class="k">if</span> <span class="n">artists_rasterized</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3064</span>     <span class="n">_draw_rasterized</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">artists_rasterized</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3066</span> <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3067</span>     <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3069</span> <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3070</span> <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\image.py:131,</span> in <span class="ni">_draw_list_compositing_images</span><span class="nt">(renderer, parent, artists, suppress_composite)</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span> <span class="k">if</span> <span class="n">not_composite</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">has_images</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span>     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">131</span>         <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="c1"># Composite any adjacent images together</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="n">image_group</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\collections.py:972,</span> in <span class="ni">_CollectionWithSizes.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">    </span><span class="mi">969</span> <span class="nd">@artist</span><span class="o">.</span><span class="n">allow_rasterization</span>
<span class="g g-Whitespace">    </span><span class="mi">970</span> <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">971</span>     <span class="bp">self</span><span class="o">.</span><span class="n">set_sizes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sizes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">972</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\collections.py:409,</span> in <span class="ni">Collection.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="n">renderer</span><span class="o">.</span><span class="n">draw_markers</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span>         <span class="n">gc</span><span class="p">,</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">combined_transform</span><span class="o">.</span><span class="n">frozen</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span>         <span class="n">mpath</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">offsets</span><span class="p">),</span> <span class="n">offset_trf</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">facecolors</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">409</span>     <span class="n">renderer</span><span class="o">.</span><span class="n">draw_path_collection</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>         <span class="n">gc</span><span class="p">,</span> <span class="n">transform</span><span class="o">.</span><span class="n">frozen</span><span class="p">(),</span> <span class="n">paths</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">411</span>         <span class="bp">self</span><span class="o">.</span><span class="n">get_transforms</span><span class="p">(),</span> <span class="n">offsets</span><span class="p">,</span> <span class="n">offset_trf</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">412</span>         <span class="bp">self</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edgecolor</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">413</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_linewidths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linestyles</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_antialiaseds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_urls</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span>         <span class="s2">&quot;screen&quot;</span><span class="p">)</span>  <span class="c1"># offset_position, kept for backcompat.</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span> <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">418</span> <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nn">File ~\mambaforge\envs\py311\Lib\site-packages\matplotlib\path.py:211,</span> in <span class="ni">Path.vertices</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_simplify_threshold</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;path.simplify_threshold&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_should_simplify</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_simplify_threshold</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>         <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;path.simplify&#39;</span><span class="p">]</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>         <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">128</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span>         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_codes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_codes</span> <span class="o">&lt;=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">211</span> <span class="nd">@property</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span> <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">214</span><span class="sd">     The list of vertices in the `Path` as an Nx2 numpy array.</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<section id="paralelizacion">
<h3>Paralelización<a class="headerlink" href="#paralelizacion" title="Enlazar permanentemente con este título">#</a></h3>
<p>Esto toma tiempo, pues a más elementos y grupos, más tiempo de ejecución</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># inertia = []</span>
<span class="c1"># for n_clusters in range(2, 15):</span>
<span class="c1">#     kmeans = KMeans(n_clusters=n_clusters).fit(df_scaled)</span>
<span class="c1">#     inertia.append(kmeans.inertia_ / n_clusters)</span>
</pre></div>
</div>
</div>
</div>
<p>Pero se puede paralelizar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://coderzcolumn.com/tutorials/python/joblib-parallel-processing-in-python</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span><span class="p">,</span> <span class="n">effective_n_jobs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Número de procesadores para usar</span>
<span class="n">effective_n_jobs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ejemplo mínimo</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span> 
<span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">)(</span><span class="n">i</span><span class="p">)</span> <span class="c1"># (función)(parametro)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: total: 15.6 ms
Wall time: 5.13 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span> 
<span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">8</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">)(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: total: 62.5 ms
Wall time: 2.62 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ahora sí con kmeans</span>
<span class="k">def</span> <span class="nf">f_kmeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span> <span class="o">/</span> <span class="n">n_clusters</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">f_kmeans</span><span class="p">)(</span><span class="n">cn</span><span class="p">)</span> <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: total: 40.5 s
Wall time: 22.5 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">f_kmeans</span><span class="p">)(</span><span class="n">cn</span><span class="p">)</span> <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: total: 1min 24s
Wall time: 15.9 s
</pre></div>
</div>
</div>
</div>
</section>
<section id="seleccionar-numero-de-grupos">
<h3>Seleccionar número de grupos<a class="headerlink" href="#seleccionar-numero-de-grupos" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_inertias</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="s1">&#39;inertia&#39;</span><span class="p">:</span> <span class="n">inertia</span><span class="p">})</span>
<span class="n">df_inertias</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_clusters</th>
      <th>inertia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>130381.095987</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>32127.176986</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>15805.228129</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>9896.683744</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>5298.512329</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>4060.861328</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>2843.499042</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>2181.361510</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>1875.066962</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11</td>
      <td>1409.378543</td>
    </tr>
    <tr>
      <th>10</th>
      <td>12</td>
      <td>1145.766584</td>
    </tr>
    <tr>
      <th>11</th>
      <td>13</td>
      <td>957.706043</td>
    </tr>
    <tr>
      <th>12</th>
      <td>14</td>
      <td>852.702798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_inertias</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">inertia</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Número de grupos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Media de las distancias cuadradas entre grupos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">inertia</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_no_supervisado_37_0.png" src="../_images/4_no_supervisado_37_0.png" />
</div>
</div>
<p>Para calcular el número de grupos por el método del codo, se calculan las distancias entre cada punto y la recta que va del primero al último. Generalmente, la primer distancia mayor corresponde con el mejor número de grupos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/a/21566184/3113008</span>
<span class="c1"># De aquí sacamos la ecuación de la recta entre el punto primero y último</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">ones</span><span class="p">,</span><span class="n">vstack</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">lstsq</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">df_inertias</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">inertia</span><span class="p">),</span>
    <span class="p">(</span><span class="n">df_inertias</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">inertia</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">x_coords</span><span class="p">,</span> <span class="n">y_coords</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">points</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">x_coords</span><span class="p">,</span> <span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_coords</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y_coords</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_inertias</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">inertia</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_inertias</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">:]</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">:]</span><span class="o">.</span><span class="n">inertia</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39;$d_{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39; = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">inertia</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">$&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">m</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">+</span> <span class="n">b</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">m</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">+</span> <span class="n">b</span><span class="p">),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">],</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">inertia</span><span class="p">,</span> <span class="n">m</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">+</span> <span class="n">b</span><span class="p">],</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Número de grupos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Media de las distancias cuadradas entre grupos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">16.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.15</span> <span class="o">*</span> <span class="n">df_inertias</span><span class="o">.</span><span class="n">inertia</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_no_supervisado_40_0.png" src="../_images/4_no_supervisado_40_0.png" />
</div>
</div>
<p>La mayor distancia se obtiene con <span class="math notranslate nohighlight">\(k = 4\)</span>, por lo que se toma como mejor número de <span class="math notranslate nohighlight">\(k\)</span> por el método del codo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>También se puede usar el método <strong>Silhouette</strong> (pero es más pesado que el método del codo 😓)</p>
<div class="math notranslate nohighlight">
\[
\text{s} = \frac{a-b}{\max(a,b)}
\]</div>
<p>donde <span class="math notranslate nohighlight">\(a\)</span> es la distancia media entre los puntos dentro del grupo más cercano y <span class="math notranslate nohighlight">\(b\)</span> es la distancia media entre cada punto respecto a todos los demás que están en los otros grupos a los que no pertenece. Los resultados obtenidos van de <span class="math notranslate nohighlight">\(1\)</span> (las medias parten de grupos bien diferenciados) a <span class="math notranslate nohighlight">\(-1\)</span> (las medias de los grupos indican que sus elementos), pasando por <span class="math notranslate nohighlight">\(0\)</span> (distancias entre grupos se considera no significativa).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="n">sample_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">)</span> <span class="o">//</span> <span class="mi">30</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5306323366215466
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="agrupamiento-jerarquico">
<h2>Agrupamiento jerárquico<a class="headerlink" href="#agrupamiento-jerarquico" title="Enlazar permanentemente con este título">#</a></h2>
<p>Este tipo de agrupamiento parte de <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> datos con <span class="math notranslate nohighlight">\(p\)</span> parámetros entre los cuales se pueden medir distancias <span class="math notranslate nohighlight">\(d_{i,j}, i, j \in n, i \neq j\)</span> para formar <span class="math notranslate nohighlight">\(N \in \mathbb{N}\)</span> grupos <span class="math notranslate nohighlight">\(A, B, C, \ldots\)</span> con distancias <span class="math notranslate nohighlight">\(D_{A,B}; D_{A,C}; D_{B,C}; \ldots\)</span> usadas para medir la disimilitud entre grupos. Cabe señalar que existen <a class="reference external" href="https://scikit-learn.org/stable/modules/clustering.html#different-linkage-type-ward-complete-average-and-single-linkage">diferentes distancias entre elementos y grupos</a> que se pueden usar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">AgglomerativeClustering</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clustering</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="n">distance_threshold</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n_clusters</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">clustering</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_scaled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10000</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Estos resultados se pueden mostrar en dendogramas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_dendrogram.html</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span>

<span class="k">def</span> <span class="nf">plot_dendrogram</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Create linkage matrix and then plot the dendrogram</span>

    <span class="c1"># create the counts of samples under each node</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">children_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">merge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">children_</span><span class="p">):</span>
        <span class="n">current_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">child_idx</span> <span class="ow">in</span> <span class="n">merge</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">child_idx</span> <span class="o">&lt;</span> <span class="n">n_samples</span><span class="p">:</span>
                <span class="n">current_count</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># leaf node</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">current_count</span> <span class="o">+=</span> <span class="n">counts</span><span class="p">[</span><span class="n">child_idx</span> <span class="o">-</span> <span class="n">n_samples</span><span class="p">]</span>
        <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_count</span>

    <span class="n">linkage_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span>
        <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">children_</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">distances_</span><span class="p">,</span> <span class="n">counts</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Plot the corresponding dendrogram</span>
    <span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plot_dendrogram</span><span class="p">(</span><span class="n">clustering</span><span class="p">,</span> <span class="n">truncate_mode</span> <span class="o">=</span> <span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>
<span class="c1"># plt.savefig(&#39;dendogram.pdf&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_no_supervisado_51_0.png" src="../_images/4_no_supervisado_51_0.png" />
</div>
</div>
</section>
<section id="tarea-en-clase-2-puntos">
<h2>Tarea en clase (2 puntos)<a class="headerlink" href="#tarea-en-clase-2-puntos" title="Enlazar permanentemente con este título">#</a></h2>
<ul class="simple">
<li><p>Investigar sobre algún otro algoritmo no supervisado que pueda usarse en tu código. Da un panorama sobre el modelo matemático que emplea y explica por qué conviene aplicarlo a tus datos. Algunos modelos que no se vieron en clase son <em>Affinity Propagation</em>, BIRCH, DBSCAN, <em>Mean Shift</em>, <em>Nearest Neighbors</em>, OPTICS, <em>Spectral Clustering</em>, TSNE, entre otros</p></li>
<li><p>Investigar otras estrategias para determinar número de grupos en estos algoritmos (como los índices de Calinski-Harabasz o de Davies-Bouldin), elegir la más adecuada al método que elegiste</p></li>
</ul>
</section>
<section id="tarea-8-puntos">
<h2>Tarea (8 puntos)<a class="headerlink" href="#tarea-8-puntos" title="Enlazar permanentemente con este título">#</a></h2>
<ul class="simple">
<li><p>Aplicar al menos un algoritmo no supervisado a tus datos para encontrar estructuras subyacentes</p></li>
<li><p>Elegir alguna métrica para determinar número de grupos, usarla y discutirla</p></li>
<li><p>Busca alguna revista científica que publique trabajos relacionados con el tuyo</p></li>
<li><p>Crea artículo mediante Latex con base en los lineamientos de la revista elegida y redacta ahí tus resultados, discusiones y bibliografía</p></li>
<li><p>Sube el código de tu tarea, los archivos de Latex y el PDF del artículo en tu repositorio, claramente diferenciados</p></li>
</ul>
</section>
<section id="recursos">
<h2>Recursos<a class="headerlink" href="#recursos" title="Enlazar permanentemente con este título">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://fesan818181.medium.com/unsupervised-learning-algorithms-explanaition-and-simple-code-b7f695a9e2cd">https://fesan818181.medium.com/unsupervised-learning-algorithms-explanaition-and-simple-code-b7f695a9e2cd</a></p></li>
<li><p><a class="reference external" href="https://machinelearningmastery.com/clustering-algorithms-with-python/">https://machinelearningmastery.com/clustering-algorithms-with-python/</a></p></li>
<li><p><a class="reference external" href="https://medium.com/imagescv/top-8-most-important-unsupervised-machine-learning-algorithms-with-python-code-references-1222393b5077">https://medium.com/imagescv/top-8-most-important-unsupervised-machine-learning-algorithms-with-python-code-references-1222393b5077</a></p></li>
<li><p><a class="reference external" href="https://builtin.com/data-science/unsupervised-learning-python">https://builtin.com/data-science/unsupervised-learning-python</a></p></li>
<li><p><a class="reference external" href="https://www.datanovia.com/en/lessons/determining-the-optimal-number-of-clusters-3-must-know-methods/">https://www.datanovia.com/en/lessons/determining-the-optimal-number-of-clusters-3-must-know-methods/</a></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/how-many-clusters-6b3f220f0ef5">https://towardsdatascience.com/how-many-clusters-6b3f220f0ef5</a></p></li>
<li><p><a class="reference external" href="https://medium.com/analytics-vidhya/concept-of-gowers-distance-and-it-s-application-using-python-b08cf6139ac2">https://medium.com/analytics-vidhya/concept-of-gowers-distance-and-it-s-application-using-python-b08cf6139ac2</a></p></li>
<li><p><a class="reference external" href="https://github.com/wwwjk366/gower">https://github.com/wwwjk366/gower</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./caps"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="3_sel_carac.html" title="anterior página">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">anterior</p>
            <p class="prev-next-title">Selección de características</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="5_supervisado.html" title="siguiente página">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title">Aprendizaje supervisado</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Alberto Benavides<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>